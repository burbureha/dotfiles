"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[7831],{48298:(e,t,s)=>{s.d(t,{kn:()=>p,kj:()=>g,Tr:()=>h});var i=s(58129),r=s(75246),o=s(19889),a=s(50906),n=s(54642),l=s(76464),d=s(9953),u=s(30149),m=s(44653),c=s(98905);const p=async e=>{const{environment:t,store:s,accessRequestStore:i,forActor:r,status:n,from:m}=e,c=t.currentUser.id;if("approved"===n){const e={type:"existingUser",value:r,spaceRole:"read_and_write"};if(!(await l.n_({environment:t,store:s,inviteTargets:[e],inviteRole:"read_and_write",isOnboarding:!1,invite:{inviteOrigin:"membership_request"}})).success)return}u.createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,perform:e=>{d.sW({store:i,transaction:e,data:{granted_time:Date.now(),granted_by_table:o.KJ,granted_by_id:c,resolved_time:Date.now(),resolved_by_table:o.KJ,resolved_by_id:c,status:n}})}}),a.trackResolveMembershipRequest(t,{status:n,request_id:i.id,from:m,for_actor_id:r.id,space_role:s.getRole()})};async function g(e){if(c.Z.reset(),!e.canAdmin)return;const{environment:t,spaceId:s}=e,i=await n.getUnreadAccessRequestCount(t,{parentTable:r.bx,parentId:s,size:1});"success"===i.type&&c.Z.setState({spaceId:s,count:i.data.count})}function h(e,t){const s=new Map;for(const r of t){const t=(0,m.Kv)(e,{table:i.J8,id:r}),a=t.getValue();if(!a)continue;if(a.for_actor_table!==o.KJ||a.created_by_table!==o.KJ)continue;const n=(0,m.Kv)(e,{table:a.for_actor_table,id:a.for_actor_id}).getValue();if(!n)continue;const l=(0,m.Kv)(e,{table:a.created_by_table,id:a.created_by_id}).getValue();if(l)if(s.has(a.for_actor_id)){const e=s.get(a.for_actor_id);if(!e)continue;a.created_time>e.latestRequestTime?s.set(a.for_actor_id,{...e,createdByActorsWithReason:[{actor:l,reason:a.message},...e.createdByActorsWithReason],accessRequest:a,accessRequestStore:t,latestRequestTime:a.created_time}):s.set(a.for_actor_id,{...e,createdByActorsWithReason:[...e.createdByActorsWithReason,{actor:l,reason:a.message}]})}else s.set(a.for_actor_id,{forActor:n,createdByActorsWithReason:[{actor:l,reason:a.message}],accessRequest:a,accessRequestStore:t,latestRequestTime:a.created_time})}return Array.from(s.values())}},86125:(e,t,s)=>{s.d(t,{Z:()=>l});var i=s(77094),r=s.n(i),o=s(67294),a=s(5366),n=s(74136);function l(e){return o.createElement(n.Z,e,"membership_admin"===e.role?r()(a.FormattedMessage,{id:"spacePermissionsSettings.user.membershipAdmin",defaultMessage:"Membership admin",description:"Label that shows on a user that is a workspace membership admin."}):r()(a.FormattedMessage,{id:"spacePermissionsSettings.user.workspaceOwner",defaultMessage:"Workspace owner",description:"Label that shows on a user that is a workspace owner."}))}},21752:(e,t,s)=>{s.d(t,{K:()=>m,Z:()=>c});var i=s(77094),r=s.n(i),o=(s(67294),s(7928)),a=s(5366),n=s(86125),l=s(88198),d=s(64369),u=s(45653);function m(e){return"membership_admin"===e?"membership_admin":"editor"===e?"admin":"none"===e?"guest":void 0}const c=function(e){const t=(0,a.useIntl)(),{userValue:s,containerStyle:i,id:m,spaceRole:c,avatarBadge:p,isLarge:g}=e,h="guest"===c,b="admin"===c||"membership_admin"===c;return r()("div",{style:{display:"flex",alignItems:"center",maxWidth:g?"unset":300,marginLeft:g?2:0,...i}},void 0,r()("div",{style:{position:"relative",...!g&&{height:28,width:28}}},void 0,r()(u.Z,{userValue:s,size:g?32:28}),p),r()("div",{style:{minWidth:0,marginLeft:g?10:6,marginRight:g?10:6}},void 0,r()("div",{id:m,style:{display:"flex",gap:4}},void 0,r()(d.Z,{className:"notranslate"},void 0,(0,o.Nz)(t,s)),b&&r()(n.Z,{role:c}),h&&r()(l.b,{})),r()(d.Z,{isSmall:!0,style:{display:"flex"}},void 0,r()(d.Z,{isSmall:!0},void 0,null==s?void 0:s.email))))}},64131:(e,t,s)=>{s.d(t,{Z:()=>A});var i=s(77094),r=s.n(i),o=s(97464),a=s.n(o),n=s(67294),l=s(480),d=s(16489),u=s(24405),m=s(8848),c=s(3779),p=s(70203),g=s(82990),h=s(5366),b=s(50906),f=s(98724),v=s(60709),S=s(98742),y=s(89086),M=s(52689),w=s(63334),C=s(24666),k=s(41216),T=s(64921),Z=s(31945),P=s(56940),R=s(58261),I=s(78140),F=s(32163),x=s(40721),G=s(72495),B=s(58032);const q=n.Fragment;const A=function(e){const{disabled:t,style:s}=e,i=(0,d.qz)(e.ignoreSelectionAreaStore,w.Z),o=(0,l.O7)(),A=(0,h.useIntl)(),_=(0,u.Fg)(),L=(0,n.useCallback)((()=>{f.aS({environment:o,annotation:["h",M.Z.state.color]}),b.trackRichTextMenuClick(o,{action:"h",color:M.Z.state.color})}),[o]),U=(0,n.useCallback)((e=>{b.trackRichTextMenuClick(o,{action:"h"})}),[o]),D=(0,n.useCallback)((()=>{C.default.emit()}),[]),E=(0,n.useCallback)((e=>{f.mX({environment:o,annotationType:"h"}),"default"!==e&&(M.Z.setHighlightColor(e),L())}),[o,L]),O=(0,n.useCallback)(((e,t,s,i)=>({key:t||e,action:()=>{s(),E(e),i.close()},render:s=>n.createElement(k.Z,a()({},s,{color:e,overrideDisplayName:t}))})),[E]),K=(0,d.VK)((()=>{const e=(0,y.Ld)("h");return e?p.zI(e):"default"}),[]),V=(0,u.yK)((e=>({colorIcon:{display:"inline-flex",alignItems:"center",justifyContent:"center",height:18,textAlign:"center",fontSize:15,borderRadius:2,...!o.device.isMobile&&{width:18,fontWeight:g.Z.fontWeight.medium,marginBottom:2},...(0,m.A_)(K,e)}})),[o.device.isMobile,K]);return r()(Z.Z,{popupType:o.device.isMobile?Z.Z.PopupType.SlideUp:Z.Z.PopupType.Popup,originGap:4,onClose:D,onClick:U,renderOrigin:e=>r()(B.Z,{renderTooltip:()=>r()(q,{},void 0,r()("div",{},void 0,r()(h.FormattedMessage,{defaultMessage:"Text color",id:"highlightSelectionButton.textColor.tooltip"})),r()("div",{},void 0,r()(R.Z,{style:{color:_.mediumInvertedTextColor},name:"toggleHighlight"}))),render:i=>n.createElement(T.Z,a()({style:{display:"flex",alignItems:"center",paddingLeft:7,paddingRight:6,whiteSpace:"nowrap",...s},disabled:t,disabledFeedback:t},(0,S.Z)(e,i)),r()("div",{style:V.colorIcon},void 0,o.device.isMobile?r()(h.FormattedMessage,{defaultMessage:"Color",id:"highlightSelectionButton.mobileColorIcon.label"}):"A"),c.Z.chevronDown({width:10,marginLeft:o.device.isMobile?4:3,fill:"dark"===_.mode?m.ZP.white:_.lightIconColor}))}),render:e=>{let t;return t=o.device.isMobile?{menuType:v.o.Modal,title:r()(h.FormattedMessage,{defaultMessage:"Text color",id:"highlightSelectionButton.mobileTextColor.label"}),right:r()(x.CancelMenuText,{}),onClickRight:()=>{e.close()}}:{menuType:v.o.Popup},n.createElement(I.Z,t,r()(P.Z,{capture:o.device.isMobile,store:i,ignoreBlockSelection:!1,restoreSelection:!0,focusOffscreenInput:!1,render:t=>{const s=m.CY.map((s=>O(s,void 0,t,e))),i=[O("default",A.formatMessage({defaultMessage:"Default background",id:"highlightSelectionButton.defaultBackground.label"}),t,e),...m._K.map((s=>O(s,void 0,t,e)))],o=M.Z.state.color;return r()(F.Z,{type:F.i.Vertical,sections:[{key:0,items:[{key:0,action:()=>{t(),E(o),e.close()},render:e=>n.createElement(k.Z,a()({},e,{color:o,shortcuts:["toggleHighlight"]}))}],render:e=>n.createElement(G.Z,a()({},e,{title:r()(h.FormattedMessage,{defaultMessage:"Last used",id:"highlightSelectionButton.lastUsedSection.label"}),isTitleUppercase:!0}))},{key:1,items:s,render:e=>n.createElement(G.Z,a()({},e,{title:r()(h.FormattedMessage,{defaultMessage:"Color",id:"highlightSelectionButton.colorSection.label"}),isTitleUppercase:!0}))},{key:2,items:i,render:e=>n.createElement(G.Z,a()({},e,{title:r()(h.FormattedMessage,{defaultMessage:"Background",id:"highlightSelectionButton.backgroundSection.label"}),isTitleUppercase:!0}))}],initialFocus:void 0})}}))}})}},82945:(e,t,s)=>{s.d(t,{Z:()=>S});var i=s(97464),r=s.n(i),o=s(77094),a=s.n(o),n=s(67294),l=s(83355),d=s(3779),u=s(5366),m=s(50906),c=s(7476),p=s(77505),g=s(24666),h=s(64921),b=s(58261),f=s(58032);class v extends l.Z{constructor(){super(...arguments),this.handleClick=e=>{let t;const s=g.default.state;"empty"!==s.mode&&(t=p.UQ(),c.WD({environment:this.environment,blockStore:this.props.blockStore,multiSelection:s.multiSelection})),m.trackRichTextMenuClick(this.environment,{action:"comment",from:t?"simple_table_cell":void 0})}}renderComponent(){const{device:e}=this.environment,t=e.isMobile;return a()(f.Z,{renderTooltip:()=>a()(n.Fragment,{},void 0,a()("div",{},void 0,a()(u.FormattedMessage,{defaultMessage:"Comment on selected text",id:"inlineCommentButton.tooltip"})),a()("div",{},void 0,a()(b.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"comment"}))),render:e=>n.createElement(h.Z,r()({style:{display:"flex",alignItems:"center",padding:"0 10px",whiteSpace:"nowrap",...this.props.style},disabled:this.props.disabled,disabledFeedback:this.props.disabled,onClick:this.handleClick},e),d.Z.speechBubbleThin({width:t?18:16,height:t?18:16,marginTop:t?0:1,marginRight:4}),!t&&a()(u.FormattedMessage,{defaultMessage:"Comment",id:"inlineCommentButton.commentLabel"}))})}}const S=v},40464:(e,t,s)=>{s.d(t,{Z:()=>v});var i=s(77094),r=s.n(i),o=s(97464),a=s.n(o),n=s(67294),l=s(480),d=s(16489),u=s(24405),m=s(8848),c=s(50906),p=s(98724),g=s(89086),h=s(24666),b=s(64921),f=s(58032);const v=function(e){const{disabled:t,type:s,tooltipLabel:i,children:o,style:v,onClick:S}=e,y=(0,l.O7)(),M=(0,n.useCallback)((e=>{p.aS({environment:y,annotation:[s]}),S&&S(),c.trackRichTextMenuClick(y,{action:s})}),[y,s,S]),w=(0,d.VK)((()=>t||"editing"!==h.default.state.mode),[t]),C=(0,d.VK)((()=>Boolean((0,g.Ld)(s))),[s]),k=(0,u.yK)((e=>({button:{display:"flex",alignItems:"center",padding:"0 8px",color:C?m.ZP.blue:e.regularTextColor,...v}})),[C,v]);return r()(f.Z,{renderTooltip:()=>i,render:e=>n.createElement(b.Z,a()({style:k.button,disabled:w,disabledFeedback:w,onClick:M},e),o)})}},32404:(e,t,s)=>{s.d(t,{Z:()=>S});var i=s(97464),r=s.n(i),o=s(77094),a=s.n(o),n=s(67294),l=s(83355),d=s(70203),u=s(5366),m=s(36280),c=s(89086),p=s(66949),g=s(24666),h=s(64921),b=s(58261),f=s(58032);class v extends l.Z{constructor(){super(...arguments),this.renderMenuTooltip=()=>{const e=this.getThemeColors();return a()(n.Fragment,{},void 0,a()("div",{},void 0,a()(u.FormattedMessage,{id:"richTextMenu.equationButton.tooltip",defaultMessage:"Create equation"})),a()("div",{},void 0,a()(b.Z,{style:e.keyboardShortcut,name:"openEquationMenu"})))},this.handleButtonPopupClick=e=>{const{onClick:t}=this.props;m.qn({environment:this.environment,analyticsFrom:"rich_text_menu"}),t&&t(e)},this.isSelected=()=>(0,c.Ld)(d.GK.Equation),this.isDisabled=()=>{const{disabled:e}=this.props;if(e)return!0;if("editing"!==g.default.state.mode&&!p.Z.isOpen())return!0;const t={[d.GK.User]:d.GK.User,[d.GK.Page]:d.GK.Page,[d.GK.Comment]:d.GK.Comment,[d.GK.Bot]:d.GK.Bot,[d.GK.Date]:d.GK.Date,[d.GK.ExternalObjectInstance]:d.GK.ExternalObjectInstance,[d.GK.TemporaryPage]:d.GK.TemporaryPage,[d.GK.TemplateVariable]:d.GK.TemplateVariable,[d.GK.FormulaPageProperty]:d.GK.FormulaPageProperty,[d.GK.FormulaUserProperty]:d.GK.FormulaUserProperty,[d.GK.FormulaContextValue]:d.GK.FormulaContextValue,[d.GK.Group]:d.GK.Group};for(const s of Object.values(t))if((0,c.J6)(s))return!0;return!1},this.styles={equationButton:{display:"flex",alignItems:"center",borderRadius:0,paddingLeft:7,paddingRight:8}}}renderComponent(){const{style:e,children:t}=this.props,s=this.getThemeColors(),i=this.isDisabled();return a()(f.Z,{renderTooltip:this.renderMenuTooltip,render:o=>n.createElement(h.Z,r()({style:{...this.styles.equationButton,...s.equationButton,...e},disabled:i,disabledFeedback:i,onClick:this.handleButtonPopupClick},o),t)})}getThemeColors(){return{equationButton:{color:this.isSelected()?this.theme.blueColor:this.theme.regularTextColor},keyboardShortcut:{color:this.theme.mediumInvertedTextColor}}}}const S=(0,u.injectIntl)(v)},73383:(e,t,s)=>{s.d(t,{Z:()=>y});var i=s(97464),r=s.n(i),o=s(77094),a=s.n(o),n=s(67294),l=s(83355),d=s(70203),u=s(5366),m=s(50906),c=s(45990),p=s(89086),g=s(23178),h=s(24666),b=s(64921),f=s(58261),v=s(58032);class S extends l.Z{constructor(){super(...arguments),this.handleButtonPopupClick=()=>{c.dz({type:"focusOnly",focus:!0}),m.trackRichTextMenuClick(this.environment,{action:d.GK.Link})}}renderComponent(){const e=(0,p.Ld)(d.GK.Link),t=this.isDisabled();return a()(v.Z,{renderTooltip:()=>a()(n.Fragment,{},void 0,a()("div",{},void 0,a()(u.FormattedMessage,{defaultMessage:"Add link",id:"selectionLinkButton.addLink.tooltip",description:"Prompt for the user to add a URL to link to from the selected text."})),a()("div",{},void 0,a()(f.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"openLinkMenu"}))),render:s=>n.createElement(b.Z,r()({style:{display:"flex",alignItems:"center",borderRadius:0,paddingLeft:7,paddingRight:8,...e&&{color:this.theme.blueColor},whiteSpace:"nowrap",...this.props.style},disabled:t,disabledFeedback:t},s,{onClick:this.handleButtonPopupClick}),this.props.children)})}isDisabled(){return!!this.props.disabled||("editing"!==h.default.state.mode&&!g.Z.state.open||!!((0,p.J6)(d.GK.User)||(0,p.J6)(d.GK.Bot)||(0,p.J6)(d.GK.Date)||(0,p.J6)(d.GK.Page)))}}const y=(0,u.injectIntl)(S)},46721:(e,t,s)=>{s.d(t,{Z:()=>zt});var i=s(97464),r=s.n(i),o=s(77094),a=s.n(o),n=s(96486),l=s.n(n),d=s(67294),u=s(83355),m=s(8848),c=s(31942),p=s(3779),g=s(27006),h=s(75246),b=s(19889),f=s(2438),v=s(47425),S=s(97880),y=s(82990),M=s(7928),w=s(5366),C=s(48298),k=s(50906),T=s(54642),Z=s(42925),P=s(47307),R=s(92625),I=s(76464),F=s(64964),x=s(29974),G=s(21325),B=s(30149),q=s(4708),A=s(60709),_=s(67669),L=s(33665),U=s(38755),D=s(21115),E=s(8323),O=s(23537),K=s(77907),V=s(79315),W=s(88632),N=s(10161),z=s(44653),H=s(72087),j=s(64404),Q=s(92083),$=s(78291),J=s(98905),Y=s(12318),X=s(21752),ee=s(42922),te=s(64921),se=s(52275),ie=s(31945),re=s(61519),oe=s(73063),ae=s(74194),ne=s(68785),le=s(78140),de=s(32163),ue=s(63296),me=s(77137),ce=s(72495),pe=s(62385),ge=s(24006),he=s(58032),be=s(64369),fe=s(21202),ve=s(26111),Se=s(15010),ye=s(84210),Me=s(61766),we=s(28992),Ce=s(43765),ke=s(89728),Te=s(11470);const Ze=(0,w.defineMessages)({removingGuest:{id:"guestPagesPopup.removeGuest.updatingMessage",defaultMessage:"Updating…"},addingMember:{id:"guestPagesPopup.addMemberPermission.updatingMessage",defaultMessage:"Updating…"}});class Pe extends u.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:Me.Z},this.renderPopup=()=>{const{device:e}=this.environment,{store:t,guest:s}=this.props,i=t.canEditMembership(),o=s.guestPageIds.map((e=>{const s=z.G.createChildStore(t,{table:fe.iU,id:e});return{key:e,render:e=>d.createElement(Te.Z,r()({},e,{store:s,placeholder:a()(w.FormattedMessage,{id:"guestPagesPopup.privatePagePlaceholder",defaultMessage:"Private page"})})),action:()=>{const s=z.G.createChildStore(t,{table:fe.iU,id:e}),i=(0,ye.Z)({store:s,fullyQualified:!1});ve.navigate({environment:this.environment,url:i,openInNew:"tab"})}}}));let n,l;return n=e.isMobile?{menuType:A.o.ActionSheet}:{menuType:A.o.Popup,width:300},(0,D.qF)(this.environment)&&(l=a()(he.Z,{renderTooltip:()=>this.isSubscribed()?a()(w.FormattedMessage,{id:"guestPagesPopup.addMemberPermissionButton.tooltip",defaultMessage:"This guest will become a member of this workspace."}):a()(w.FormattedMessage,{id:"guestPagesPopup.addAdminPermissionButton.tooltip",defaultMessage:"This guest will become an admin of this workspace."}),render:e=>d.createElement(ue.Z,r()({isLarge:!0,onClick:this.handleConvertToMemberClick},e),this.isSubscribed()?a()(w.FormattedMessage,{id:"guestPagesPopup.addMemberPermissionButton.label",defaultMessage:"Convert to member"}):a()(w.FormattedMessage,{id:"guestPagesPopup.addAdminPermissionButton.label",defaultMessage:"Convert to admin"}))})),d.createElement(le.Z,n,i&&a()(we.Z,{title:a()("div",{style:{paddingTop:12,paddingBottom:8,display:"flex",alignItems:"flex-start"}},void 0,l,a()(he.Z,{renderTooltip:()=>a()(w.FormattedMessage,{id:"guestPagesPopup.removeGuestButton.tooltip",defaultMessage:"This guest will be removed from all pages in this Workspace."}),render:e=>d.createElement(ue.Z,r()({isLarge:!0,isRed:!0,style:{marginLeft:l?8:0},onClick:this.handleRemoveClick},e),a()(w.FormattedMessage,{id:"guestPagesPopup.removeGuestButton.label",defaultMessage:"Remove"}))}))}),i&&a()(Ce.Z,{title:a()(w.FormattedMessage,{id:"guestPagesPopup.guestAccessiblePagesCaption",defaultMessage:"This guest can access these pages"})}),a()(de.Z,{type:de.i.Vertical,initialFocus:0,sections:[{key:"pages",render:e=>d.createElement(ce.Z,e),items:o}]}))},this.handleRemoveClick=()=>{P.showDialog({showCancel:!0,keepFocus:!1,message:a()(w.FormattedMessage,{id:"guestPagesPopup.removeGuestModal.confirmationMessage",defaultMessage:"Are you sure you want to remove this person? They will lose access to all shared pages."}),items:[{label:a()(w.FormattedMessage,{id:"guestPagesPopup.removeGuestModal.removeButton.label",defaultMessage:"Remove"}),color:"red",onAccept:async()=>{const{guest:e,store:t}=this.props;this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!1}),R.j({message:Ze.removingGuest});"success"===(await T.removeUsersFromSpace(this.environment,{userIds:[e.userId],spaceId:t.id,removePagePermissions:!0,revokeUserTokens:!1})).type&&(await G.bi(this.environment),k.trackRemoveGuest(this.environment)),R.x()}}]})},this.handleConvertToMemberClick=async()=>{const{store:e,guest:t,guestStore:s,isSubscribed:i}=this.props,r=i?"read_and_write":"editor",o=[{type:"user_permission",role:r,user_id:t.userId}],{serverCommitResult:a}=B.createAndCommit({userAction:"GuestPagesPopup.handleConvertToMemberClick",environment:this.environment,perform:t=>{I.ep({environment:this.environment,store:e,permissionItems:o,transaction:t,from:"convert_to_member"})}});this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!1}),R.j({message:Ze.addingMember});try{await a,await G.bi(this.environment),k.trackConvertGuestToMember(this.environment,{member_user_id:t.userId}),k.trackEmailInvite(this.environment,{role:r,is_space:!0,invite_targets:[{type:"existingUser",value:{id:s.id,version:s.getKeyStore("version").getValue()||0,email:s.getEmail()||""},spaceRole:"none"}],is_onboarding:!1,invite_origin:"convert_to_member",permission_items:o,invite_message_length:0,domainType:(0,Se.JF)()})}finally{R.x()}}}renderComponent(){const{device:e}=this.environment,{buttonPopupStore:t}=this.stores,{store:s,guest:i}=this.props;return i.guestPageIds.map((e=>{z.G.createChildStore(s,{table:fe.iU,id:e}).load()})),0===i.guestPageIds.length?a()(w.FormattedMessage,{id:"guestPagesPopup.permissionsForUserGuest.label",defaultMessage:"Guest"}):a()(ie.Z,{popupType:e.isMobile?ie.Z.PopupType.SlideUp:ie.Z.PopupType.Popup,renderOrigin:e=>d.createElement(ke.Z,e,a()(w.FormattedMessage,{id:"guestPagesButton.label",defaultMessage:"{numberOfAccessiblePages, plural, one {{numberOfAccessiblePages} page} other {{numberOfAccessiblePages} pages}}",values:{numberOfAccessiblePages:i.guestPageIds.length}}),p.Z.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor})),buttonPopupStore:t,render:this.renderPopup})}isSubscribed(){const{data:e}=$.default.state;return Boolean(e&&(0,D.YK)(e))}}const Re=(0,w.injectIntl)(Pe);var Ie=s(74523),Fe=s(42402),xe=s(7567),Ge=s(480),Be=s(16489),qe=s(24405),Ae=s(5851),_e=s(53680),Le=s(93963),Ue=s(40235),De=s(42875),Ee=s(61784),Oe=s(89837),Ke=s(29302),Ve=s(45653);function We(e){const{store:t,request:s}=e,{forActor:i,accessRequestStore:r}=s,o=(0,Ge.O7)(),[n,l]=(0,d.useState)(!1),u=(0,qe.yK)((e=>({actionButtons:{display:"flex",alignItems:"center",gap:12},email:{display:"flex",gap:4},requestMetadata:{minWidth:0,marginLeft:6,marginRight:6},tooltip:{marginBottom:2},tooltipHeader:{color:e.mediumInvertedTextColor,fontSize:10,textTransform:"uppercase",letterSpacing:"0.015em",marginBottom:2},viewReasonsButton:{marginLeft:28,marginTop:2,border:"none"},tooltipUserRow:{display:"flex",justifyContent:"space-between",marginBottom:4},tooltipUserRowEmail:{marginLeft:5}})),[]),m=(0,w.useIntl)(),c=(0,Be.VK)((()=>{var e;const t=[],i=new Set;return null===(e=s.createdByActorsWithReason)||void 0===e||e.forEach((e=>{i.has(e.actor.id)||t.push(e.actor),i.add(e.actor.id)})),t}),[s.createdByActorsWithReason]);if(!s||!s.forActor||!s.createdByActorsWithReason.length)return null;const p=Oe.CQ(s.latestRequestTime,(0,De.r)()),g=(0,Ee.ZV)({value:p,date_format:"relative",userTimeZone:(0,De.r)(),intl:m,allowRelativeDates:!0}),h={environment:o,store:t,accessRequestStore:r,forActor:i},b=c.filter((e=>e.email!==s.forActor.email)),f=b.length!==c.length,v=()=>1===c.length?a()(w.FormattedMessage,f?{defaultMessage:"Guest self request",id:"spaceSettingsRequests.requestRowAction.requestedBySingularGuestSelfRequest",description:"Describes that a request came from a guest self request."}:{defaultMessage:"From {actorName}",id:"spaceSettingsRequests.requestRowAction.requestedBySingular",description:"Describes the user that a request came from",values:{actorName:c[0].name}}):a()(w.FormattedMessage,f?{defaultMessage:"{numberOfOtherActors, plural, one {Guest self request and from {secondActorName}} other {Guest self request and from {numberOfOtherActors} more}}",id:"spaceSettingsRequests.requestRowAction.requestedByPluralIncludingGuestSelfRequest",description:"Describes the guest self request and the multiple users that a request came from",values:{secondActorName:b[0].name,numberOfOtherActors:b.length}}:{defaultMessage:"{numberOfOtherActors, plural, one {From {firstActorName} and {secondActorName}} other {From {firstActorName} and {numberOfOtherActors} more}}",id:"spaceSettingsRequests.requestRowAction.requestedByPlural",description:"Describes multiple users that a request came from",values:{firstActorName:c[0].name,secondActorName:c[1].name,numberOfOtherActors:c.length-1}});return a()("div",{style:{width:"100%"}},void 0,a()("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},void 0,a()("div",{},void 0,a()("div",{style:{display:"flex",alignItems:"center"}},void 0,a()(Ve.Z,{userValue:s.forActor,size:28,borderStyle:"dashed"}),a()("div",{style:u.requestMetadata},void 0,a()("div",{style:u.email},void 0,a()(be.Z,{className:"notranslate"},void 0,s.forActor.email)),a()(be.Z,{isSmall:!0},void 0,a()(he.Z,{renderTooltip:()=>a()("div",{style:u.tooltip},void 0,a()(be.Z,{style:u.tooltipHeader},void 0,a()(w.FormattedMessage,{defaultMessage:"Requested by",id:"spaceSettingsRequests.requestRowAction.requestedByMoreThanTwo.tooltip",description:"Describes multiple user emails that a request came from"})),c.map((e=>a()("div",{style:u.tooltipUserRow},e.id,a()(Ke.Z,{avatarSize:18,userValue:e}),a()("div",{style:u.tooltipUserRowEmail},void 0,e.email))))),render:e=>d.createElement("span",e,a()(v,{}))})," · ",g)))),a()("div",{style:u.actionButtons},void 0,a()(ke.Z,{isGray:!0,onClick:async()=>{await(0,C.kn)({...h,status:"rejected",from:"requests_center"})}},void 0,a()(w.FormattedMessage,{defaultMessage:"Decline",id:"spaceSettingsRequests.requestRowAction.declineButton.label",description:"Label for button that allows user to reject a pending membership request"})),a()(ue.Z,{isBlue:!0,onClick:async()=>{await(0,C.kn)({...h,status:"approved",from:"requests_center"})}},void 0,a()(w.FormattedMessage,{defaultMessage:"Approve",id:"spaceSettingsRequests.requestRowAction.acceptButton.label",description:"Label for button that allows user to approve a pending membership request"})))),s.createdByActorsWithReason.some((e=>{let{reason:t}=e;return Boolean(t)}))&&a()(ue.Z,{isSmall:!0,isBlue:!0,style:u.viewReasonsButton,onClick:()=>l(!n)},void 0,a()(w.FormattedMessage,n?{id:"spaceSettingsRequests.requestRowAction.closeReasonsButton.label",defaultMessage:"Close reasons",description:"Button to collapse reasons in view for a membership request."}:{id:"spaceSettingsRequests.requestRowAction.viewReasonsButton.label",defaultMessage:"View reasons",description:"Button to expand reasons for a membership request."})),n&&a()("div",{style:{marginLeft:34,marginTop:2,fontSize:y.Z.fontSize.UIRegular.desktop}},void 0,s.createdByActorsWithReason.filter((e=>{let{reason:t}=e;return Boolean(t)})).map(((e,t)=>a()("div",{},t,e.actor.name," · ",e.reason)))))}function Ne(e){const{spaceStore:t,accessRequestRenderValues:s,lastOpenedRequestCenterTime:i}=e,r=(0,Be.VK)((()=>s.filter((e=>"pending"===e.accessRequestStore.getKeyStore("status").getValue())).sort(((e,t)=>t.latestRequestTime-e.latestRequestTime))),[s]),o=(0,qe.yK)((e=>({requestColumn:{width:"100%"},zeroStateContainer:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",padding:40,color:e.mediumTextColor,borderStyle:"solid",borderColor:e.regularDividerColor,borderWidth:1,borderRadius:3},mailIcon:{height:12,width:17,color:e.mediumIconColor,marginRight:6}})),[]),n={key:"request",header:void 0,style:o.requestColumn};return 0===r.length?a()("div",{style:o.zeroStateContainer},void 0,p.Z.mailRound(o.mailIcon),a()(w.FormattedMessage,{id:"spaceSettingsRequests.emptyRequests.message",defaultMessage:"No invite requests yet",description:"Message in requests inbox telling user there are no requests yet."})):a()(Ue.Z,{hideHeader:!0,columns:[n],rows:r.map(((e,s)=>({key:`request${s.toString()}`,columns:[a()("div",{style:{display:"flex",alignItems:"center"}},e.accessRequest.id,i<e.accessRequest.created_time&&a()("div",{style:{marginLeft:-18,marginRight:10}},void 0,a()(Le.z,{size:8})),a()(We,{store:t,request:e}))]})))})}function ze(e){const{spaceStore:t,accessRequestsStore:s}=e,i=(0,Ge.O7)(),[r,o]=(0,d.useState)(Date.now()),[,,n]=(0,Be.AF)(void 0,_e.Z),l=(0,Be.VK)((()=>n.getValueForSpace(t)),[t,n]),u=Boolean(null==l?void 0:l.disableMembershipRequests),m=Boolean(null==l?void 0:l.disableGuestMembershipRequests),c=(0,Be.VK)((()=>t.getKeyStore("settings").getKeyStore("seen_guest_membership_requests").getValue()&&(0,q.Ye)(i)),[i,t]),[p,,]=(0,Be.AF)(s),g=(0,qe.yK)((e=>({errorContainer:{display:"flex",justifyContent:"center",alignItems:"center",padding:40,color:e.mediumTextColor}})),[]);(0,d.useEffect)((()=>{const{currentSpaceViewStore:e}=V.default.state;if(!e)return;const t=e.getKeyStore("settings").getKeyStore("last_opened_request_center").getValue();t&&o(t),B.createAndCommit({userAction:"SpaceSettingsRequests.updateLastOpened",environment:i,perform:t=>{B.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings","last_opened_request_center"],command:"set",args:Date.now()},transaction:t})}})}),[]);return h=p.error,b=p.result,p.ready?h||!b?a()("div",{style:g.errorContainer},void 0,a()(w.FormattedMessage,{defaultMessage:"Something went wrong.",id:"notificationUpdates.unknownErrorMessage"})):d.createElement(d.Fragment,null,a()(He,{spaceStore:t,securitySettingsStoreState:l,disabled:u}),c&&a()(je,{spaceStore:t,securitySettingsStoreState:l,disabled:m}),a()(Ne,{spaceStore:t,accessRequestRenderValues:b,lastOpenedRequestCenterTime:r})):a()("div",{style:g.errorContainer},void 0,a()(ne.Z,{}));var h,b}function He(e){const t=(0,Ge.O7)(),{spaceStore:s,securitySettingsStoreState:i,disabled:r}=e,o=(0,qe.yK)((()=>({toggleContainer:{display:"flex",alignItems:"center",cursor:"pointer",marginBottom:14},titleDescription:{fontSize:14,marginRight:8,flexGrow:1},description:{marginTop:2,width:"80%"}})),[]);return a()("div",{style:o.toggleContainer,onClick:function(){i&&(0,Ae.n)(t,{securitySettingsState:{...i,disableMembershipRequests:!i.disableMembershipRequests},spaceStore:s})}},void 0,a()("div",{style:o.titleDescription},void 0,a()(w.FormattedMessage,{id:"spaceSettingsRequests.allowMembersToRequestMembers.title",description:"Title for a setting that, when on, will allow workspace members to request users to become workspace members.",defaultMessage:"Allow members to request adding other members"}),a()(be.Z,{isSmall:!0,isMultiline:!0,style:o.description},void 0,a()(w.FormattedMessage,{id:"spaceSettingsRequests.allowMembersToRequestMembers.description",description:"Description for a setting that, when on, will allow workspace members to request users to become workspace members.",defaultMessage:"Members can submit requests to admins to add more members"}))),a()(ge.Z,{on:!r}))}function je(e){const t=(0,Ge.O7)(),{spaceStore:s,securitySettingsStoreState:i,disabled:r}=e,o=(0,qe.yK)((()=>({toggleContainer:{display:"flex",alignItems:"center",cursor:"pointer",marginBottom:14},titleDescription:{fontSize:14,marginRight:8,flexGrow:1},description:{marginTop:2,width:"80%"}})),[]);return a()("div",{style:o.toggleContainer,onClick:function(){i&&(0,Ae.n)(t,{securitySettingsState:{...i,disableGuestMembershipRequests:!i.disableGuestMembershipRequests},spaceStore:s})}},void 0,a()("div",{style:o.titleDescription},void 0,a()(w.FormattedMessage,{id:"spaceSettingsRequests.allowGuestsToSelfRequest.title",description:"Title label for workspace toggle that enables guest self-request membership feature.",defaultMessage:"Allow page guests to request to be added as members to the workspace"}),a()(be.Z,{isSmall:!0,isMultiline:!0,style:o.description},void 0,a()(w.FormattedMessage,{id:"spaceSettingsRequests.allowGuestsToSelfRequest.description",description:"Description of label for workspace toggle that enables guest self-request membership feature.",defaultMessage:"Guests of the workspace can submit requests to admins to be added as members"}))),a()(ge.Z,{on:!r}))}var Qe=s(29825),$e=s(83890),Je=s(98707),Ye=s(27386),Xe=s(23189),et=s(40394),tt=s(33929),st=s(33846),it=s(31194),rt=s(48690),ot=s(30397),at=s(48019),nt=s(68894),lt=s(93686);const dt=(0,w.defineMessages)({filterTeams:{defaultMessage:"Filter teamspaces…",id:"teamsDropdownForGroupMenu.filterForTeams.placeholder",description:"Placeholder text for filtering teamspaces within a group."}});function ut(e){const t=(0,Ge.O7)(),s=(0,qe.yK)((()=>({teamMenuItem:{fontWeight:400}})),[]),[i,o]=(0,Be.AF)(void 0,st.Z),[,n]=(0,Be.AF)(rt.Z),l=(0,d.useCallback)((e=>{n((t=>({...t,open:!0,tab:rt.a.Members,selectedTeamId:e})))}),[n]),u=(0,Be.VK)((()=>[{key:"teams for group",render:e=>d.createElement(ce.Z,e),actions:e.teamStores.map((e=>({key:e.id,displayName:e.getName(),analyticsName:e.getName()||"team_unknown",searchName:e.getName(),render:t=>d.createElement(se.Z,r()({icon:a()(lt.p,{disabled:!0,store:e}),title:a()(be.Z,{style:s.teamMenuItem},void 0,e.getName()),right:a()(w.FormattedMessage,{defaultMessage:"{numMembers} {numMembers, plural, one {member} other {members}}",id:"teamsInGroupMenu.filterForTeams.numMembers",description:"Number of members in a teamspace, displayed in a popup showing teamspaces connected to a group.",values:{numMembers:e.getUserIdsInTeam().length}})},t)),action:()=>{l(e.id)},closeParentMenu:!0})))}]),[s,e.teamStores,l]),m=i.inputValue,c=a()(at.Z,{filter:m,context:{blocks:[],environment:t,publicEditMode:void 0},sections:u,initialFocus:0}),p=a()(ce.Z,{isInput:!0},void 0,a()(nt.ZP,{value:m,onChange:(0,d.useCallback)((e=>{o({inputValue:e.target.value,focus:!1})}),[o]),focus:!0,focusAfterAnimation:!0,placeholder:tt.default.formatMessage(dt.filterTeams)})),g={menuType:A.o.Popup,width:280,maxHeight:"50vh",header:e.teamStores.length>5?p:void 0};return d.createElement(le.Z,g,c)}const mt=function(e){const t=(0,Be.qz)(void 0,Me.Z),[s]=(0,Be.AF)(ot.Z),i=(0,qe.yK)((e=>({button:{marginRight:8},noTeams:{marginRight:8,color:e.lightTextColor},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),o=(0,Be.VK)((()=>s.teams.filter((t=>t.getMembers().some((t=>"group"===t.entity_type&&t.group_id===e.group.id))))),[s,e.group]);return a()(ie.Z,{popupType:ie.Z.PopupType.Popup,renderOrigin:e=>d.createElement(ke.Z,r()({disabled:0===o.length,style:0===o.length?i.noTeams:i.button},e),0===o.length?a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.userGroup.teamsCountNone",defaultMessage:"None",description:"Button for displaying that this group is not part of any teamspaces."}):a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.userGroup.teamsCount",defaultMessage:"{numberOfTeams, plural, one {{numberOfTeams} teamspace} other {{numberOfTeams} teamspaces}}",description:"Button for displaying how many teamspaces this group is a part of.",values:{numberOfTeams:o.length}}),o.length>0&&p.Z.chevronDown(i.chevron)),buttonPopupStore:t,placementToOrigin:it.Iw.Bottom,render:e=>a()(ut,{parent:e,teamStores:o}),onClose:(0,d.useCallback)((()=>{t.reset()}),[t])})};var ct=s(38363),pt=s(19522),gt=s(93405),ht=s(44532);function bt(e){const{group:t,spaceStore:s,settingsStore:i}=e,o=(0,Be.qz)(void 0,Me.Z);return a()(ie.Z,{popupType:ht.kQ.Popup,render:()=>a()(ft,{group:t,spaceStore:s,popupStore:o,settingsStore:i}),buttonPopupStore:o,renderOrigin:e=>d.createElement(oe.Z,r()({icon:p.Z.dots},e))})}function ft(e){const{group:t,spaceStore:s,popupStore:i,settingsStore:o}=e,n=(0,O.Gc)(),u=(0,Be.VK)((()=>s.canAdmin()),[s]),m=(0,Ge.O7)(),c=(0,qe.yK)((e=>({deleteButton:{color:e.redBadgeBackground}})),[]),p=(0,d.useCallback)((async()=>{i.setState({open:!1});await P.confirmUserAction({message:a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.deleteGroupModal.confirmationMessage",defaultMessage:"Are you sure you want to delete this group? Any pages that are private to this group will be transferred to you."}),acceptLabel:a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.deleteGroupModal.confirmationButton.label",defaultMessage:"Yes"})})&&(await B.createAndCommitAsync({environment:m,userAction:"SpacePermissionGroup.handleDelete",waitForServerCommit:!1,perform:async e=>{await x.Xv({environment:m,spaceStore:s,group:t,transaction:e})}}),k.trackPermissionGroupDelete(m))}),[t,m,s,i]),g=(0,d.useCallback)((()=>{o.setState({...o.state,editingNameGroupId:t.id,groupNameInputValue:t.name||""}),i.setState({open:!1}),k.trackPermissionGroupRename(m)}),[t,m,i,o]),h=(0,d.useCallback)((()=>{pt.Z.setState({...pt.Z.state,name:t.name||"",defaultInviteTargets:[{type:"group",value:t}]}),ct.lo("group_settings")}),[t]),b={key:"action_menu",render:e=>d.createElement(ce.Z,e),items:l().compact([{key:"rename",render:e=>d.createElement(gt.Z,r()({},e,{title:a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.groupList.actionMenu.renameItem",defaultMessage:"Rename"})})),action:g},n?{key:"create_team_from_group",render:e=>d.createElement(gt.Z,r()({},e,{title:a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.groupList.actionMenu.createTeamFromGroup",defaultMessage:"Create teamspace from group",description:"Button text shown when you click on the three-dot menu of a group in group settings. Clicking on it allows you to create a teamspace using the group's information."})})),action:h}:void 0,u&&{key:"delete",render:e=>d.createElement(gt.Z,r()({},e,{title:a()("div",{style:c.deleteButton},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.groupList.actionMenu.deleteItem",defaultMessage:"Delete"}))})),action:p}])};return a()(le.Z,{menuType:A.o.Popup},void 0,a()(de.Z,{type:de.i.Vertical,initialFocus:0,sections:[b],onAccept:()=>{i.setState({open:!1})}}))}var vt=s(16639),St=s(49085);class yt extends St.Z{getInitialState(){return{userInputValue:"",temporaryUserIds:[],limitUsers:!0}}}const Mt=yt;var wt=s(86125),Ct=s(33728),kt=s(31299),Tt=s(92864),Zt=s(47082),Pt=s(97680);function Rt(e){const{group:t,spaceStore:s,groupStore:i}=e,o=(0,Be.qz)(void 0,Me.Z),n=(0,qe.yK)((()=>({popup:{width:400},button:{marginTop:4}})),[]);return a()(ie.Z,{popupType:ht.kQ.Popup,render:()=>a()(It,{spaceStore:s,group:t,popupStore:o,groupStore:i}),buttonPopupStore:o,onClose:()=>i.setState({userInputValue:"",temporaryUserIds:[],limitUsers:!0}),style:n.popup,renderOrigin:e=>a()("div",{},void 0,d.createElement(ke.Z,r()({isGray:!0,icon:p.Z.plus,style:n.button},e),a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.groupList.addMemberButton.label",defaultMessage:"Add members"})))})}function It(e){const t=(0,Ge.O7)(),s=(0,w.useIntl)(),{group:i,spaceStore:r,popupStore:o,groupStore:n}=e,u=(0,Be.VK)((()=>n.state.temporaryUserIds.map((e=>{const t=r.getRecordValue({table:b.KJ,id:e});return a()(Tt.vw,{userValue:t,format:Tt.vw.Format.Medium,showRemoveButton:!0,onClickRemove:()=>{const t=n.state.temporaryUserIds.filter((t=>t!==e));n.setState({...n.state,temporaryUserIds:t})},shouldShrink:!0,isSingle:!1},e)}))),[r,n]),m=(0,Be.VK)((()=>()=>{const{temporaryUserIds:e}=n.state,s=i.user_ids||[],a=l().union(s,e),d={...i,user_ids:a,last_edited_time:Date.now()};B.createAndCommit({userAction:"SpacePermissionGroup.handleAddDoneClick",environment:t,perform:e=>{x.jF({spaceStore:r,group:d,transaction:e})}}),n.setState({userInputValue:"",temporaryUserIds:[],limitUsers:!0}),o.setState({open:!1}),k.trackPermissionGroupAddMembers(t,{add_member_count:e.length})}),[i,t,n,o,r]),c=(0,d.useCallback)((()=>{const{temporaryUserIds:e}=n.state,t=e.slice(0,e.length-1);n.setState({...n.state,temporaryUserIds:t})}),[n]),p=(0,d.useCallback)((e=>{const t=e.target.value,{extractedEmails:s,newInputValue:i}=(0,Ct.zI)(t),{currentSpaceStore:r}=V.default.state,{data:o}=$.default.state;if(!o||!r)return;const a=(0,D.CM)(o).map((e=>e.userId)),d=l().compact(a.map((e=>z.U6.createChildStore(r,{table:b.KJ,id:e}).getValue()))).filter((e=>s.includes(e.email)&&!n.state.temporaryUserIds.includes(e.id)));n.setState({...n.state,temporaryUserIds:[...n.state.temporaryUserIds,...d.map((e=>e.id))],userInputValue:i})}),[n]),g=(0,Be.VK)((()=>n.state.userInputValue),[n]),h=(0,Be.VK)((()=>n.state.temporaryUserIds),[n]);return a()(le.Z,{menuType:A.o.Popup,tokenInputHeader:!0,header:a()(Zt.Z,{focus:!0,disabled:!1,focusAfterAnimation:!0,format:Zt.Z.Format.Group,tokens:u,placeholder:s.formatMessage({id:"spacePermissionsSettings.groupsTab.userGroup.userSearchInput.placeholder",defaultMessage:"Search for a person…"}),onRemoveLastToken:c,value:g,onChange:p,inputAndTokenWrapRightStyle:{paddingTop:t.device.isMobile?0:6,paddingBottom:t.device.isMobile?0:6},right:a()(ee.Z,{isLarge:!0,onClick:m},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.userGroup.addUserButton.label",defaultMessage:"Add"}))})},void 0,a()(me.Z,{request:{query:g,temporaryUserIds:h},performRequest:async s=>{let{query:i,temporaryUserIds:r}=s;const o=e.group.user_ids||[];return(await kt.Yu({environment:t,query:i,membersOnly:!0})).filter((e=>o.indexOf(e.id)<0&&r.indexOf(e.id)<0)).slice(0,20)},render:(e,t)=>a()(Ft,{results:t,spaceStore:r,groupStore:n})}))}function Ft(e){const{spaceStore:t,groupStore:s}=e,[i,o]=(0,Be.AF)(s,Mt),n=(e.results||[]).map((e=>{let{id:t}=e;return t})),l=(0,Be.VK)((()=>n.map((e=>{const s=z.U6.createChildStore(t,{table:b.KJ,id:e}).getValue();return{key:e,render:e=>d.createElement(Pt.Z,r()({},e,{user:s,useEmailAsTooltip:!0})),action:()=>{const t=[...i.temporaryUserIds,e];o({...i,temporaryUserIds:t,userInputValue:""})}}}))),[t,o,i,n]);if(0===n.length)return a()(ce.Z,{},void 0,a()(Ce.Z,{title:a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.userGroup.searchUserDropdown.noResultsMessage",defaultMessage:"No results"})}));{const e={key:"user_menu",render:e=>d.createElement(ce.Z,e),items:l};return a()(de.Z,{type:de.i.Vertical,initialFocus:0,sections:[e]})}}function xt(e){const{group:t,canEdit:s,spaceStore:i,settingsStore:o}=e,n=(0,Be.qz)(void 0,Mt),{groupMembers:l,remainingMembers:u}=(0,Be.VK)((()=>{const{countRemainingUsers:e,totalNumberMembers:s,limitedUserValues:r}=(0,vt.rm)({group:t,spaceStore:i,limit:n.state.limitUsers&&!o.state.groupsFilter?10:void 0});return{groupMembers:(0,vt.N5)({userValues:r,spaceValue:{permissions:i.getPermissionItems()}}),remainingMembers:e,totalMembers:s}}),[t,i,o,n]);return a()("div",{style:{padding:"4px 42px 8px"}},void 0,l.map((t=>d.createElement(Gt,r()({key:t.id,userValue:t},e)))),u>0&&a()(ke.Z,{isGray:!0,style:{marginTop:4},onClick:()=>{n.setState({...n.state,limitUsers:!1})}},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.showMoreUsersButton.label",defaultMessage:"{numberOfHiddenUsers, plural, one {Show {numberOfHiddenUsers} more} other {Show {numberOfHiddenUsers} more}}",values:{numberOfHiddenUsers:u}})),s?a()(Rt,{group:t,spaceStore:i,groupStore:n}):l.length<1&&a()(ke.Z,{disabled:!0,isGray:!0},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.groupList.noMembersInside",defaultMessage:"No members inside",description:"A label saying that there are no members inside this group."})))}function Gt(e){const{spaceStore:t,userValue:s,group:i,canEdit:r}=e,o=(0,Ge.O7)(),n=(0,Be.VK)((()=>t.isDefined()?(0,_.su)({permissions:t.getPermissionItems()},s.id):"none"),[t,s]);return a()("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},s.id,a()("div",{style:{display:"flex"}},void 0,a()(Ke.Z,{userValue:s,style:{fontSize:14,fontWeight:400,lineHeight:"17px",paddingRight:6,minHeight:34,width:"100%"},avatarSize:22}),(0,g.Bc)(n)&&a()(wt.Z,{role:"membership_admin"===n?"membership_admin":"admin"})),r&&a()(ke.Z,{isGray:!0,hoveredStyle:{color:m.ZP.red},onClick:async()=>{if(await P.confirmUserAction({message:a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.removeMemberFromGroupDialog.confirmationMessage",defaultMessage:"Are you sure you want to remove this member?"}),acceptLabel:a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.removeMemberFromGroupDialog.confirmationButton.label",defaultMessage:"Yes"})})){const e=(i.user_ids||[]).filter((e=>e!==s.id)),r={...i,user_ids:e,last_edited_time:Date.now()};B.createAndCommit({userAction:"SpacePermissionGroup.renderUser",environment:o,perform:e=>{x.jF({spaceStore:t,group:r,transaction:e})}}),k.trackPermissionGroupRemoveMember(o)}}},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.removeMemberFromGroupButton.label",defaultMessage:"Remove"})))}var Bt=s(13991),qt=s(22808),At=s(49312),_t=s(12793),Lt=s(3386),Ut=s(31278),Dt=s(5210);function Et(e){const{row:t,canEdit:s,open:i,toggleOpenState:o,spaceStore:n,settingsStore:l}=e,u=t.group,m=(0,w.useIntl)(),c=(0,qe.Fg)(),g=(0,Ge.O7)(),h=vt.kF({intl:m,group:u}),b=(0,qe.yK)((e=>({container:{display:"flex",justifyContent:"flex-start",alignItems:"center",width:"100%"},toggle:{flexShrink:0,marginRight:2},chevron:{width:12,height:12,transition:"transform 200ms ease-out",transform:`rotateZ(${i?0:-90}deg)`,fill:"inherit",opacity:.5,marginRight:4},name:{fontFamily:y.Z.getCompositeFontFamily(Bt.SP).sans,fontSize:14,lineHeight:"17px",marginRight:4},input:{fontWeight:y.Z.fontWeight.medium,padding:"4px 6px",background:e.contentBackgroundTransparent},icon:{marginRight:9}})),[i]),f=(0,d.useCallback)((e=>{const t={...u,icon:e,last_edited_time:Date.now()};B.createAndCommit({userAction:"SpacePermissionGroup.handleIconChange",environment:g,perform:e=>{x.jF({spaceStore:n,group:t,transaction:e})}}),k.trackPermissionGroupSetIcon(g,{is_emoji:(0,qt.Z)(e)})}),[u,n,g]),v=(0,d.useCallback)((()=>{l.setState({...l.state,editingNameGroupId:void 0,groupNameInputValue:""})}),[l]),S=(0,d.useCallback)((e=>{l.setState({...l.state,groupNameInputValue:e.target.value})}),[l]),M=(0,d.useCallback)((()=>{const{editingNameGroupId:e,groupNameInputValue:t}=l.state,s=t.trim();if(e===u.id){if(s!==u.name){const e={...u,name:s,last_edited_time:Date.now()};B.createAndCommit({userAction:"SpacePermissionGroup.handleNameAccept",environment:g,perform:t=>{x.jF({spaceStore:n,group:e,transaction:t})}})}l.setState({...l.state,editingNameGroupId:void 0,groupNameInputValue:""})}}),[u,g,n,l]),C=(0,Be.VK)((()=>l.state.editingNameGroupId===u.id),[u,l]),T=(0,Be.VK)((()=>l.state.groupNameInputValue),[l]);function Z(e){const t={width:e-4,height:e-4,fill:c.mediumIconColor},s={width:12,height:12,fill:c.mediumIconColor};return a()("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"}},void 0,p.Z.random(t),p.Z.plusThick(s))}return a()("div",{style:b.container},void 0,a()(Dt.Z,{isSidebar:!1,fill:!0,icon:"chevron",open:i,color:c.mediumIconColor,onClick:()=>o(u.id),style:b.toggle}),a()(_t.Z,{size:28,style:b.icon}),C?a()(Lt.Z,{capture:!0,onEsc:v},void 0,a()(ae.Z,{disabled:!s,type:At.Z.Type.Inline,style:b.input,placeholder:m.formatMessage({id:"spacePermissionsSettings.groupsTab.userGroup.groupNameInput.placeholder",defaultMessage:"Untitled"}),focus:!0,value:T,onChange:S,onBlur:M,onSubmit:M})):a()(be.Z,{style:b.name,showTooltipWhenTruncated:!0},void 0,h),(P=t.isRowHovered,u.icon?a()(Ut.Z,s?{disabled:!1,bucket:"public",icon:u.icon?{pointer:n.pointer,icon:u.icon}:void 0,size:18,isEmptyPage:!1,title:h,onChange:f,style:b.icon}:{disabled:!0,bucket:"public",icon:u.icon?{pointer:n.pointer,icon:u.icon}:void 0,size:18,isEmptyPage:!1,title:h,style:b.icon}):P&&s?a()(he.Z,{renderTooltip:()=>a()(w.FormattedMessage,{defaultMessage:"Add icon",id:"spacePermissionsSettings.groupsTab.userGroup.groupIcon.tooltip",description:"Tooltip explaining that user can add an icon for a group"}),render:e=>d.createElement(Ut.Z,r()({disabled:!1,bucket:"public",icon:u.icon?{pointer:n.pointer,icon:u.icon}:void 0,size:18,isEmptyPage:!1,title:h,onChange:f,style:{...b.icon,width:30},defaultIcon:Z(18)},e))}):void 0));var P}function Ot(e){let{groups:t,canEdit:s,spaceStore:i,permissionsSettingsStore:r}=e;const[o,n]=(0,d.useState)([]),l=(0,qe.Fg)(),u=(0,O.Gc)(),m=(0,Be.VK)((()=>(0,c.ZP)(r.state.groupsFilter,t,(e=>e.name||""))),[r,t]),p=(0,d.useCallback)((e=>{n((t=>t.includes(e)?t.filter((t=>t!==e)):t.concat(e)))}),[n]),g=(0,d.useMemo)((()=>function(e){return e.map((e=>({id:e.id,group:e,isClickable:!1})))}(m)),[m]),h=(0,d.useMemo)((()=>function(e){let{openRowIds:t,toggleOpenRowId:s,canEdit:i,spaceStore:r,settingsStore:o,isTeamEnabled:n}=e;const l={id:"title",headerTitle:a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.spaceGroupsTable.groups",defaultMessage:"Group",description:"Title of the groups column of the groups table."}),renderCell:e=>a()(Et,{row:e,open:t.includes(e.id),toggleOpenState:s,canEdit:i,spaceStore:r,settingsStore:o}),widthData:{width:120},hasClickableContents:!1,sortable:!1},d={id:"teams",headerTitle:a()("div",{style:{paddingLeft:8}},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.spaceGroupsTable.teams",defaultMessage:"Teamspaces",description:"Title of the teamspaces column of the groups table."})),renderCell:e=>a()("div",{style:y.Z.textOverflowStyle},void 0,a()(mt,{group:e.group})),widthData:{width:40},hasClickableContents:!1,sortable:!1},u={id:"members",headerTitle:a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.spaceGroupsTable.member",defaultMessage:"Members",description:"Title of the members column of the groups table."}),renderCell:e=>{var t;return a()("div",{style:y.Z.textOverflowStyle},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.userGroup.memberCount",defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} member} other {{numberOfGroupMembers} members}}",values:{numberOfGroupMembers:(null===(t=e.group.user_ids)||void 0===t?void 0:t.length)||0}}))},widthData:{width:40},hasClickableContents:!1,sortable:!1},m={id:"menu",headerTitle:null,renderCell:e=>a()(bt,{group:e.group,spaceStore:r,settingsStore:o}),widthData:{width:20},hasClickableContents:!0,sortable:!1};return[l,...n?[d]:[],u,...i?[m]:[]]}({openRowIds:o,toggleOpenRowId:p,canEdit:s,spaceStore:i,settingsStore:r,isTeamEnabled:u})),[o,p,s,i,r,u]),b=(0,et.b)({columnRenderInfo:h,theme:l});return a()(et.D,{showRowBorders:!0,hideHeaderRowPadding:!0,columnRenderInfo:h,rows:g,styles:b,renderNoRowsComponent:()=>a()(be.Z,{isSmall:!0,style:{marginLeft:5,marginTop:10,marginBottom:20}},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.spaceGroupsTable.noGroupsFound",defaultMessage:"No groups found.",description:"Message displayed on the groups table in space settings when there are no groups matching the user's search query."})),renderRowChild:e=>o.includes(e.id)?a()(xt,{group:e.group,canEdit:s,spaceStore:i,settingsStore:r}):void 0})}var Kt=s(66957),Vt=s(88775),Wt=s(69435);class Nt extends u.Z{constructor(){super(...arguments),this.storeTypes={spacePermissionsSettingsStore:j.Z,getRecoverableSpaceUserContentRequestStore:H.Z,accessRequestsStore:H.Z,isPageGuestsOpen:Y.default.of(!0),isTeamGuestsOpen:Y.default.of(!0)},this.userIdsWithContentBeingReprovisioned=new Y.default([]),this.renderReprovisioningData=(e,t,s)=>t?a()(Ue.Z,{columns:[{key:"user",header:a()(w.FormattedMessage,{id:"spacePermissionsSettings.userTable.userColumn.header",defaultMessage:"User"}),style:{width:"50%"}},{key:"count",header:a()(w.FormattedMessage,{id:"spacePermissionsSettings.userTable.pageCountColumn.header",defaultMessage:"Private pages",description:"Column header for number of private pages each user has"}),style:{width:"25%"}},{key:"action",header:a()(w.FormattedMessage,{id:"spacePermissionsSettings.userTable.actionLevelColumn.header",defaultMessage:"Action"}),style:{width:"25%"}}],rows:this.getSpaceRecoverRows(t.recentSpaceRecoverPages)}):!s&&a()(ne.Z,{}),this.handleUpdateClick=()=>{const e=(0,w.defineMessages)({updatingPermissions:{id:"spacePermissionsSettings.updatePermissionsMessage",defaultMessage:"Updating…"}});R.j({message:e.updatingPermissions})},this.handleUpdateComplete=()=>{R.x()},this.handleTabClick=(e,t)=>{const s=this.getCurrentTabs(t)[e];switch(s){case j.Q.Members:k.trackPermissionsSettingsTabClick(this.environment,{tab:"members"});break;case j.Q.Groups:k.trackPermissionsSettingsTabClick(this.environment,{tab:"groups"});break;case j.Q.Guests:k.trackPermissionsSettingsTabClick(this.environment,{tab:"guests"});break;case j.Q.Reprovisioning:k.trackPermissionsSettingsTabClick(this.environment,{tab:"reprovisioning"});break;case j.Q.Requests:k.trackPermissionsSettingsTabClick(this.environment,{tab:"requests"});break;default:(0,S.t1)(s)}this.stores.spacePermissionsSettingsStore.state.currentTab===j.Q.Requests&&s!==j.Q.Requests&&J.Z.reset(),this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,currentTab:s})},this.handleCreateGroupClick=()=>{B.createAndCommit({userAction:"SpacePermissionsSettings.handleCreateGroupClick",environment:this.environment,perform:e=>{const t=x.mo({environment:this.environment,spaceStore:this.props.store,transaction:e});t&&this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,editingNameGroupId:t.id,groupNameInputValue:""})}}),k.trackPermissionGroupCreate(this.environment)},this.handleFilterChange=e=>{this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,groupsFilter:e.target.value})},this.handleMembersShowMoreClick=()=>{this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,limitMembers:!1})},this.handleGuestsShowMoreClick=()=>{this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,limitGuests:!1})},this.handleTeamGuestsShowMoreClick=()=>{this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,limitTeamGuests:!1})},this.handleInviteLinkClick=()=>{const e=!this.getInviteLinkEnabled();k.trackInviteLinkUpdated(this.environment,{enabled:e}),B.createAndCommit({userAction:"SpacePermissionsSettings.handleInviteLinkClick",environment:this.environment,perform:t=>{x.ys({transaction:t,spaceStore:this.props.store,inviteLinkEnabled:Boolean(e)})}})},this.handleSortClick=(e,t)=>{const s=this.stores.spacePermissionsSettingsStore.state.sorts[e];let i;i=!(!s||s.by!==t)&&s.asc,this.stores.spacePermissionsSettingsStore.update((s=>({...s,sorts:{...s.sorts,[e]:{by:t,asc:!i}}})))},this.handleMemberPermissionRoleChange=async(e,t,s)=>{const{store:i}=this.props,r=this.environment.currentUser.id;if(e.userId!==r||"none"!==t)this.handleUpdateClick(),"none"===t?(await T.removeUsersFromSpace(this.environment,{userIds:[e.userId],spaceId:i.id,removePagePermissions:!0,revokeUserTokens:!0}),await G.bi(this.environment)):B.createAndCommit({userAction:"SpacePermissionsSettings.handleMemberPermissionRoleChange",environment:this.environment,perform:s=>I.ep({environment:this.environment,store:i,permissionItems:[{type:"user_permission",role:t,user_id:e.userId}],transaction:s,from:"space_permission_setting_table"})}),this.handleUpdateComplete();else{await x.bf({environment:this.environment,spaceId:i.id,userSettingsStore:s})&&Q.Z.setState({...Q.Z.state,open:!1})}},this.handleReprovisionToUserChange=async(e,t)=>{if(!(await P.confirmUserAction({message:a()("span",{},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.reprovisionPrivatePagesConfirmationDialog.confirmationMessage",defaultMessage:"Are you sure you want to transfer their private pages? This action cannot be undone."})),acceptLabel:a()(w.FormattedMessage,{id:"spacePermissionsSettings.reprovisionPrivatePagesConfirmationDialog.confirmButton.label",defaultMessage:"Transfer private pages"})})))return;this.userIdsWithContentBeingReprovisioned.setState([...this.userIdsWithContentBeingReprovisioned.state,e]);const s=await T.transferSpaceUserContent(this.environment,{spaceId:this.props.store.id,fromUserId:e,toUserId:t});"failed"===s.type&&P.showError(s),await this.stores.getRecoverableSpaceUserContentRequestStore.refresh(),this.userIdsWithContentBeingReprovisioned.setState(this.userIdsWithContentBeingReprovisioned.state.filter((t=>t!==e)))}}willMount(){this.setInitialSubtabOnMount()}renderComponent(){const{store:e,isMobile:t}=this.props;if(!W.Z.state.online)return this.renderOfflineMessage();const{data:s}=$.default.state;if(!s)return this.renderLoadingSpinner();const i=D.CM(s);if(!l().every(i.map((t=>z.U6.createChildStore(e,{table:b.KJ,id:t.userId}).isReady()))))return this.renderLoadingSpinner();const r=i.filter(f.CF),o=i.filter(f.du),n=(0,q.F$)()?o.length:o.filter((e=>!e.isTeamGuest&&e.isPageGuest)).length,{currentTab:u}=this.stores.spacePermissionsSettingsStore.state;if(t)return a()(d.Fragment,{},void 0,this.canEditMembership()&&a()(ce.Z,{shouldShowBottomDivider:!0},void 0,this.renderMobileInviteButton(),a()("div",{style:this.mobileMenuItemStyle()},void 0,this.renderInviteLink())),a()(ce.Z,{},void 0,this.renderSpaceMembers(r)));const m={[j.Q.Members]:d.createElement(d.Fragment,null,a()(w.FormattedMessage,{id:"spacePermissionsSettings.membersTab.title",defaultMessage:"Members"}),a()("span",{},void 0," "),a()("span",{style:{color:this.theme.lightTextColor}},void 0,r.length)),[j.Q.Groups]:a()(w.FormattedMessage,{id:"spaceBasicSettings.groupsTab.title",defaultMessage:"Groups"}),[j.Q.Guests]:d.createElement(d.Fragment,null,(0,q.F$)()?a()(w.FormattedMessage,{id:"spacePermissionsSettings.externalTab.title",defaultMessage:"External",description:"External tab in People section of settings title."}):a()(w.FormattedMessage,{id:"spacePermissionsSettings.guestsTab.title",defaultMessage:"Guests",description:"Guests tab in Members section of settings title."}),a()("span",{},void 0," "),a()("span",{style:{color:this.theme.lightTextColor}},void 0,n)),[j.Q.Reprovisioning]:a()(w.FormattedMessage,{id:"spaceBasicSettings.reprovisioningTab.title",defaultMessage:"Recently left"}),[j.Q.Requests]:d.createElement(d.Fragment,null,a()(w.FormattedMessage,{id:"spaceBasicSettings.requestsTab.title",defaultMessage:"Requests",description:"Label for a tab that shows a list of requests waiting for approval"}),a()("span",{},void 0," "),a()("span",{style:{color:this.theme.lightTextColor}},void 0,this.renderNumberOfRequests()),this.renderUnreadRequestDot())},c=this.getCurrentTabs(o),p=c.map((e=>m[e]));return a()(Ye.Z,{},void 0,(0,q.F$)()&&a()("div",{style:{display:"flex",flexDirection:"column",gap:8,marginBottom:20}},void 0,a()("div",{style:{display:"flex",alignItems:"center",gap:7}},void 0,a()(be.Z,{style:{fontWeight:y.Z.fontWeight.medium,fontSize:17}},void 0,a()(w.FormattedMessage,{id:"spaceBasicSettings.people.title",defaultMessage:"People",description:"People tab title."})),a()(Ie.Z,{href:(0,L.UY)("guides.members"),analyticsFrom:"members_settings"})),a()(be.Z,{isSecondaryColor:!0,style:{fontSize:15}},void 0,a()(w.FormattedMessage,{id:"spaceBasicSettings.people.subtitle",defaultMessage:"Manage members, external guests, groups and permissions.",description:"subtitle for section explaining what this section of the settings tab covers."}))),a()(Kt.Z,{tabs:p,selectedIndex:c.indexOf(u),onChange:e=>this.handleTabClick(e,o),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),this.renderTab(u,r,o))}renderLoadingSpinner(){return a()(ne.Z,{style:{margin:"calc(50% - 1em) auto"}})}renderOfflineMessage(){return a()(be.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."}))}renderHelp(){return a()("div",{style:{marginTop:24,marginBottom:24}},void 0,a()(Ie.Z,{title:a()(w.FormattedMessage,{id:"spacePermissionsSettings.helpButton.caption",defaultMessage:"Learn about adding members to your workspace"}),href:(0,L.UY)("guides.members"),analyticsFrom:"members_settings"}))}renderTab(e,t,s){return e===j.Q.Members?a()(d.Fragment,{},void 0,this.renderSpaceMembers(t)):e===j.Q.Guests?d.createElement(d.Fragment,null,(0,q.F$)()?this.renderExternalTab(s):this.renderSpaceGuests(s)):e===j.Q.Groups?this.renderGroupsTab():e===j.Q.Reprovisioning?this.renderReprovisioning():e===j.Q.Requests?this.renderRequestsTab():void(0,S.t1)(e)}renderExternalTab(e){return a()("div",{style:{display:"flex",flexDirection:"column",gap:8}},void 0,a()("div",{style:{display:"flex"}},void 0,a()(Dt.Z,{open:this.stores.isTeamGuestsOpen.state,onClick:()=>this.stores.isTeamGuestsOpen.setState(!this.stores.isTeamGuestsOpen.state),isSidebar:!1,fill:!0,style:{marginLeft:-27}}),a()("div",{style:{marginLeft:3}},void 0,a()("div",{style:{display:"flex",alignItems:"center",height:24}},void 0,a()(be.Z,{style:{fontSize:15}},void 0,a()(w.FormattedMessage,{id:"spacePermissionSettings.teamGuests.title",defaultMessage:"Teamspace guests",description:"Title for dropdown header for team guests members table."})),a()("span",{},void 0," "),a()(be.Z,{isSecondaryColor:!0,style:{fontSize:15}},void 0,e.filter((e=>e.isTeamGuest)).length)),a()(be.Z,{isSecondaryColor:!0,style:{fontSize:15}},void 0,a()(w.FormattedMessage,{id:"spacePermissionSettings.teamGuests.subtitle",defaultMessage:"Teamspace guests are billed as members and can access all pages in teamspaces they've been invited to.",description:"Subtitle for dropdown header for teamspace guests table explaining what page guests are."})))),this.stores.isTeamGuestsOpen.state&&this.renderTeamGuests(e),a()("div",{style:{display:"flex"}},void 0,a()(Dt.Z,{open:this.stores.isPageGuestsOpen.state,onClick:()=>this.stores.isPageGuestsOpen.setState(!this.stores.isPageGuestsOpen.state),isSidebar:!1,fill:!0,style:{marginLeft:-27}}),a()("div",{style:{marginLeft:3}},void 0,a()("div",{style:{display:"flex",alignItems:"center",height:24}},void 0,a()(be.Z,{style:{fontSize:15}},void 0,a()(w.FormattedMessage,{id:"spacePermissionSettings.pageGuests.title",defaultMessage:"Page guests",description:"Title for dropdown header for page guests members table."})),a()("span",{},void 0," "),a()(be.Z,{isSecondaryColor:!0,style:{fontSize:15}},void 0,e.filter((e=>e.isPageGuest)).length)),a()(be.Z,{isSecondaryColor:!0,style:{fontSize:15}},void 0,a()(w.FormattedMessage,{id:"spacePermissionSettings.pageGuests.subtitle",defaultMessage:"Page guests are free but can only access pages they've been invited to.",description:"Subtitle for dropdown header for page guests table explaining what page guests are."})))),this.stores.isPageGuestsOpen.state&&this.renderSpaceGuests(e))}renderUnreadRequestDot(){if(this.props.unreadAccessRequests&&this.props.unreadAccessRequests>0)return a()(Le.z,{color:this.theme.redBadgeBackground,style:{marginLeft:6}})}renderGroupsTab(){const{store:e}=this.props,{groupsFilter:t}=this.stores.spacePermissionsSettingsStore.state,s=this.canUseGroups(),i=this.canAdmin(),o=a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.workspaceOwnersOnly",defaultMessage:"Only workspace owners can add a permission group.",description:"Caption that restricts groups creation to workspace owners"});if(e.isDefined()){const n=e.getPermissionGroups();return a()("div",{},void 0,s?a()(be.Z,{isMultiline:!0,style:{width:"80%"}},void 0,(0,O.bq)()?a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.captionWithTeamsV2",defaultMessage:"Set up groups to streamline page permissions from the share menu and manage teamspace members in bulk.",description:"Describes the purpose of groups with the context of teamspaces."}):a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.caption",defaultMessage:"Set up groups to conveniently control page permissions from the share menu.",description:"Describes the purpose of groups."})):a()(Wt.Z,{for:v.$M,from:"permission_groups",icon:p.Z.group,title:a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.upgradeTitle",defaultMessage:"Upgrade to create groups"}),caption:a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.upgradeCaption.plus",defaultMessage:"Upgrade to the Plus Plan to set up groups and control permissions from the share menu.",description:"Shown as an upsell if user wants more permission control from the share menu."}),learnMoreRoute:"guides.groups"}),a()(re.Z,{size:24,isHidden:!0}),a()("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},void 0,s&&a()(he.Z,{renderTooltip:()=>!i&&o,render:e=>d.createElement(ee.Z,r()({isLarge:!0,onClick:this.handleCreateGroupClick,disabled:!i},i?void 0:e),a()(w.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.createGroupButton.label",defaultMessage:"Create a group"}))}),n.length>0&&a()(ae.Z,{placeholder:this.props.intl.formatMessage({id:"spacePermissionsSettings.groupsTab.filterGroupNamesInput.placeholder",defaultMessage:"Filter by group name…",description:"Search input placeholder shown above a table that displays all groups."}),left:p.Z.searchThick(this.getSearchIconStyle()),showClearButton:!0,format:ae.Z.Format.Small,value:t,style:{...Nt.filterStyle,marginRight:0},onChange:this.handleFilterChange})),n.length>0&&a()(Ot,{spaceStore:e,permissionsSettingsStore:this.stores.spacePermissionsSettingsStore,groups:n,canEdit:this.canEditGroups()}))}}renderSpaceMembers(e){return this.props.isMobile?this.renderMobileMemberList(e):a()("div",{},void 0,this.renderHelp(),this.renderInviteLink(),this.renderDesktopMemberList(e))}renderInviteLink(){if(!this.canUseInviteLink())return;const e=this.getInviteLink(),t=this.getInviteLinkEnabled();if(!e)return;const{spacePermissionsSettingsStore:s}=this.stores;return a()("div",{},void 0,a()("div",{style:{display:"flex",alignItems:"flex-start",cursor:"pointer"}},void 0,a()("div",{style:{marginRight:8,flexGrow:1}},void 0,a()(Xe.Z,{},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.spaceMembers.inviteLink.title",defaultMessage:"Invite link"})),a()(be.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"}},void 0,a()(w.FormattedMessage,{id:"spacePermissionSettings.spaceMembers.inviteLink.caption",defaultMessage:"Share this secret link to invite people to this workspace. Only users who can invite members can see this.",description:"Label that is shown above the invite link."})," ",!this.props.isMobile&&this.renderInviteLinkReset())),a()("div",{style:{marginTop:5}},void 0,a()(ge.Z,{on:t,onClick:this.handleInviteLinkClick}))),s&&t&&e&&this.renderInviteLinkUrl(e),a()(re.Z,{size:40}))}renderInviteLinkReset(){const{store:e}=this.props;if(e.isDefined())return a()(w.FormattedMessage,{id:"spacePermissionSettings.spaceMembers.inviteLink.resetLink",defaultMessage:"You can <resetlink>reset the link</resetlink> for all space members to generate a new invite link.",values:{resetlink:t=>a()(Fe.Z,{onClick:()=>{P.showDialog({message:a()(w.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.description",defaultMessage:"Are you sure you want to reset the invite link for all space members? Your old one will no longer be able to be used."}),showCancel:!0,keepFocus:!1,handleCancel:P.dismissDialog,items:[{label:a()(w.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.accept",defaultMessage:"Reset"}),color:"red",onAccept:async()=>{await T.refreshInviteLink(this.environment,{spaceId:e.id}),G.bi(this.environment)}}]})}},void 0,t)}})}renderInviteLinkUrl(e){const{mobileNative:t}=this.environment,s=a()(w.FormattedMessage,{id:"spacePermissionsSettings.spaceMembers.inviteLink.copyButton",defaultMessage:"Copy link"}),i=()=>{Z.RD({environment:this.environment,stringValue:e,copiedMessage:Z.tq.copiedLinkToClipboard}),k.trackWorkspaceInviteCopyLink(this.environment)},r=()=>{t&&t.share(e),k.trackWorkspaceInviteCopyLink(this.environment)};return this.props.isMobile?a()("div",{},void 0,a()(ae.Z,{type:"text",format:ae.B.Default,value:e,disabled:!0}),t?a()(ue.Z,{onClick:r,style:{marginTop:10,width:"100%"}},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.spaceMembers.inviteLink.shareButton",defaultMessage:"Share link"})):a()(ue.Z,{onClick:i,style:{marginTop:10,width:"100%"}},void 0,s)):a()("div",{},void 0,a()("div",{style:{display:"flex",alignItems:"flex-start",marginTop:12}},void 0,a()(ae.Z,{type:"text",format:ae.B.Default,value:e,disabled:!0,style:{borderTopRightRadius:0,borderBottomRightRadius:0,width:"calc(100% - 90px)",height:32}}),a()(ee.Z,{onClick:i,style:{borderTopLeftRadius:0,borderBottomLeftRadius:0},isLarge:!0},void 0,s)))}renderMobileMemberList(e){const{store:t}=this.props;return a()(d.Fragment,{},void 0,e.map((e=>{const s=z.U6.createChildStore(t,{table:b.KJ,id:e.userId}),i=s.getValue();return a()("div",{style:{display:"flex",alignItems:"center",padding:10,borderBottom:`1px solid ${this.theme.lightDividerColor}`,background:this.theme.cardContentBackground}},e.userId,this.renderMember(i),a()("div",{style:{textAlign:"center",marginLeft:"auto"}},void 0,this.renderUserPermission("members",e,s)))})))}renderDesktopMemberList(e){const{spacePermissionsSettingsStore:t}=this.stores,{membersFilter:s,limitMembers:i}=t.state,r=this.getFilteredMembers(e,s),o=this.sortUsers("members",r),n=i?o.slice(0,Nt.defaultLimit):o;return a()(d.Fragment,{},void 0,a()("div",{style:{marginRight:8,flexGrow:1}},void 0,a()(Xe.Z,{},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.spaceMembers.members.title",defaultMessage:"Members"}))),this.renderInviteViaDomainCaption(),a()(re.Z,{size:16,isHidden:!0}),a()("div",{},void 0,a()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}},void 0,this.renderInviteButton(),a()(ae.Z,{placeholder:this.props.intl.formatMessage({id:"spacePermissionsSettings.membersTab.filterMembersInput.placeholder",defaultMessage:"Filter by email or name…"}),left:p.Z.searchThick(this.getSearchIconStyle()),showClearButton:!0,format:ae.Z.Format.Small,value:s,style:Nt.filterStyle,onChange:e=>{t.setState({...t.state,membersFilter:e.target.value,limitMembers:!0})}})),this.renderUserTable("members",n),o.length>Nt.defaultLimit&&i&&a()(pe.Z,{style:Nt.showMoreButtonStyle,onClick:this.handleMembersShowMoreClick},void 0,a()(w.FormattedMessage,{defaultMessage:"Show {moreMembersCount} more",id:"spacePermissionsSettings.membersTab.showMore.message",values:{moreMembersCount:o.length-Nt.defaultLimit}}))))}renderTeamGuests(e){const{spacePermissionsSettingsStore:t}=this.stores,{teamGuestsFilter:s,limitTeamGuests:i}=t.state,r=e.filter((e=>e.isTeamGuest)),o=this.getFilteredMembers(r,s),n=this.sortUsers("team_guests",o),l=i?n.slice(0,5):n;return a()("div",{style:{marginBottom:5}},void 0,a()("div",{},void 0,a()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}},void 0,a()(ae.Z,{placeholder:this.props.intl.formatMessage({id:"spacePermissionsSettings.membersTab.filterTeamGuestsInput.placeholder",defaultMessage:"Filter by email or name…",description:"Placeholder in the search bar for teamspace guests."}),left:p.Z.searchThick(this.getSearchIconStyle()),showClearButton:!0,format:ae.Z.Format.Small,value:s,style:Nt.filterStyle,onChange:e=>{t.setState({...t.state,teamGuestsFilter:e.target.value,limitTeamGuests:!0})}})),this.renderUserTable("team_guests",l),n.length>5&&i&&a()(pe.Z,{style:Nt.showMoreButtonStyle,onClick:this.handleTeamGuestsShowMoreClick},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.membersTab.showMoreGuestsButton.label",defaultMessage:"{numberOfHiddenGuests, plural, one {Show {numberOfHiddenGuests} more} other {Show {numberOfHiddenGuests} more}}",values:{numberOfHiddenGuests:n.length-5}}))))}renderSpaceGuests(e){const{spacePermissionsSettingsStore:t}=this.stores,{guestsFilter:s,limitGuests:i}=t.state,r=e.filter((e=>e.isPageGuest)),o=this.getFilteredMembers(r,s),n=this.sortUsers("guests",o),l=(0,q.F$)()?5:Nt.defaultLimit,d=i?n.slice(0,l):n;return a()("div",{},void 0,a()("div",{},void 0,a()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}},void 0,a()(ae.Z,{placeholder:this.props.intl.formatMessage({id:"spacePermissionsSettings.membersTab.filterGuestsInput.placeholder",defaultMessage:"Filter by email or name…"}),left:p.Z.searchThick(this.getSearchIconStyle()),showClearButton:!0,format:ae.Z.Format.Small,value:s,style:Nt.filterStyle,onChange:e=>{t.setState({...t.state,guestsFilter:e.target.value,limitGuests:!0})}})),this.renderUserTable("guests",d),n.length>l&&i&&a()(pe.Z,{style:Nt.showMoreButtonStyle,onClick:this.handleGuestsShowMoreClick},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.membersTab.showMoreGuestsButton.label",defaultMessage:"{numberOfHiddenGuests, plural, one {Show {numberOfHiddenGuests} more} other {Show {numberOfHiddenGuests} more}}",values:{numberOfHiddenGuests:n.length-l}}))))}renderMobileInviteButton(){return a()(d.Fragment,{},void 0,a()("div",{style:this.mobileMenuItemStyle()},void 0,this.renderInviteButton({flex:1})),a()("div",{style:{borderBottom:`1px solid ${this.theme.regularDividerColor}`}}))}renderInviteButton(e){const{store:t}=this.props;return t.canEditMembership()||t.getDisableMembershipRequests()||!(0,q.p1)()?a()(K.LazyPermissionsInviteWithModal,{disabled:!this.canEditMembership(),store:t,onInviteClick:this.handleUpdateClick,onInviteComplete:this.handleUpdateComplete,isSubscribed:this.isSubscribed(),membersOnly:!1,upgradeButtonName:"space_permission_settings",shouldGrow:!1,buttonStyle:e}):a()(Qe.Z,{store:t,analyticsFrom:"space_settings_add_members",origin:a()(ee.Z,{isLarge:!0},void 0,a()(w.FormattedMessage,{id:"inviteUserButton.requestMemberLabel",defaultMessage:"Add members",description:"Button to invite new users to the workspace."}))})}renderInviteViaDomainCaption(){const{store:e}=this.props;return x.LV(e)?a()(be.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"}},void 0,a()(w.FormattedMessage,{id:"spaceBasicSettings.membersTab.manageMembersWithLinkCaption",defaultMessage:"Manage members here."})):a()("div",{},void 0,a()(be.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%",marginBottom:6}},void 0,a()(w.FormattedMessage,{id:"spaceBasicSettings.membersTab.manageMembersWithoutLinkCaption",defaultMessage:"Manage members here, or <setupdomainlink>set up a domain</setupdomainlink>, so everyone with allowed email domains can join the workspace automatically.",values:{setupdomainlink:e=>a()(Fe.Z,{onClick:()=>{Q.Z.setState({...Q.Z.state,currentTab:"settings",defaultSubtab:void 0})}},void 0,e)}})),a()(be.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"}},void 0,a()(w.FormattedMessage,{id:"spaceBasicSettings.membersTab.payPerMemberCaption",defaultMessage:"Note: you will be charged for each member added. Visit <billingguidelink>our guide</billingguidelink> for more information on how we bill.",values:{billingguidelink:e=>a()(Fe.Z,{href:(0,L.UY)("guides.billingGuide")},void 0,e)}})))}getFilteredMembers(e,t){const{store:s}=this.props;return t&&t.length>0?(0,c.ZP)(t,e,(e=>{const t=z.U6.createChildStore(s,{table:b.KJ,id:e.userId});return t.isDefined()?(0,M.of)({name:t.getName(),email:t.getEmail()}):""})):e}sortUsers(e,t){const s=this.stores.spacePermissionsSettingsStore.state.sorts[e];if(!s)return t;const{store:i}=this.props;switch(s.by){case"role":return t.sort(((e,t)=>(g.xm[t.role]-g.xm[e.role])*(s.asc?-1:1)));case"name":return t.map((e=>({user:e,store:z.U6.createChildStore(i,{table:b.KJ,id:e.userId})}))).sort(((e,t)=>{const i=e.store.getValue(),r=t.store.getValue(),o=(0,M.Nz)(this.props.intl,i),a=(0,M.Nz)(this.props.intl,r);return o.localeCompare(a)*(s.asc?1:-1)})).map((e=>e.user))}}renderSmallArrow(e){const{up:t}=e,s={width:10,height:10,marginLeft:4};return t?p.Z.arrowDownSmall({...s,transform:"rotate(180deg)"}):p.Z.arrowDownSmall(s)}renderUserTable(e,t){const{store:s}=this.props,i=this.stores.spacePermissionsSettingsStore.state.sorts[e],r={key:"user",header:a()(te.Z,{disabled:!1,ignoreLocalHoverState:!0,onClick:()=>{this.handleSortClick(e,"name")},style:{display:"flex",alignItems:"center"}},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.userTable.userColumn.header",defaultMessage:"User"}),i&&"name"===i.by&&this.renderSmallArrow({up:i.asc})),style:{width:"60%"}},o={key:"teams",header:a()(te.Z,{disabled:!1,ignoreLocalHoverState:!0,style:{display:"flex",alignItems:"center",paddingLeft:8}},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.userTable.teamsColumn.header",defaultMessage:"Teamspaces",description:"Label for a column shows the teamspaces that a user is part of."})),style:{width:"20%",textAlign:"center"}},n={key:"access_level",header:a()(te.Z,{disabled:!1,ignoreLocalHoverState:!0,onClick:()=>{this.handleSortClick(e,"role")},style:{display:"flex",alignItems:"center",paddingLeft:8}},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.userTable.accessLevelColumn.header",defaultMessage:"Access level"}),i&&"role"===i.by&&this.renderSmallArrow({up:i.asc})),style:{width:"20%",textAlign:"center"}},l={key:"three_dot",header:a()(te.Z,{disabled:!0,ignoreLocalHoverState:!0})},u="members"===e&&(0,O.bq)()?[r,o,n]:"team_guests"!==e&&"guests"!==e||!(0,q.F$)()?[r,n]:[r,n,l];return a()(Ue.Z,{columns:u,rows:t.map((e=>({member:e,store:z.U6.createChildStore(s,{table:b.KJ,id:e.userId})}))).filter((e=>void 0!==e.store.getValue())).map((t=>{const{member:s,store:i}=t,r=i.getValue(),o=[this.renderMember(r)];return"members"===e&&(0,O.bq)()&&o.push(d.createElement(d.Fragment,null,this.renderTeams(s))),o.push(d.createElement(d.Fragment,null,this.renderUserPermission(e,s,i))),"team_guests"!==e&&"guests"!==e||!(0,q.F$)()||o.push(d.createElement(d.Fragment,null,this.renderPageGuestOrTeamGuestThreeDotMenu(e,s,i))),{key:s.userId,columns:o}}))})}renderMember(e){return a()(X.Z,{userValue:e})}renderTeams(e){if("none"!==e.role)return a()(Vt.Z,{member:e})}renderUserPermission(e,t,s){return"none"===t.role?(0,q.F$)()&&"team_guests"===e?a()(Vt.Z,{member:t}):a()(Re,{store:this.props.store,guest:t,guestStore:s,isSubscribed:this.isSubscribed()}):this.renderMemberRoleSelect(t)}renderPageGuestOrTeamGuestThreeDotMenu(e,t,s){return a()(ie.Z,{popupType:ie.Z.PopupType.Popup,renderOrigin:e=>d.createElement(oe.Z,r()({},e,{icon:p.Z.dots,iconStyle:{height:14,width:14}})),render:i=>{const o=[{key:"team section",render:e=>d.createElement(ce.Z,e),items:[{key:"convertToMember",render:t=>d.createElement(se.Z,r()({},t,{icon:p.Z.settingsUpgrade({height:17,width:17}),title:a()(w.FormattedMessage,{id:"spacePermissionsSettings.externalTab.userThreeDotMenu.convertToMember.title",defaultMessage:"Convert to member",description:"Title for button to convert a page guest or teamspace guest to a workspace member."}),shouldWrapCaption:!0,caption:"team_guests"===e&&a()(w.FormattedMessage,{id:"spacePermissionsSettings.externalTab.userThreeDotMenu.convertToMember.caption",defaultMessage:"Workspace members are not restricted to specific teamspaces",description:"Explains teamspace guests are limited to specific teamspaces."})})),action:()=>this.handleConvertToMember({user:t,userStore:s,parent:i})},{key:"removeFromWorkspace",render:e=>d.createElement(se.Z,r()({},e,{icon:p.Z.handWave({height:17,width:17,color:m.ZP.red}),title:a()("span",{style:{color:m.ZP.red}},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.externalTab.userThreeDotMenu.removeFromWorkspace.title",defaultMessage:"Remove from workspace",description:"Button that when clicked removes the user from the workspace entirely."}))})),action:()=>this.handleRemoveFromWorkspace({user:t,userStore:s,parent:i})}]}];return a()(le.Z,{menuType:A.o.Popup},void 0,a()(de.Z,{type:de.i.Vertical,sections:o,initialFocus:void 0,style:{minWidth:265}}))}})}renderMemberRoleSelect(e){const t=this.environment.currentUser.id,{currentUserSettingsStore:s}=V.default.state;if(!s)return;const i=this.getAvailableRoleItems();let r=!0;return(this.canAdmin()||this.canEditMembership()&&(g.RN(e.role)||e.userId===t))&&(r=!1),a()(xe.Z,{role:e.role,table:h.bx,type:"user_permission",disabled:r,isUserPermission:e.userId===t,isSubscribed:this.isSubscribed(),upgradeButtonName:"space_permission_item",onChange:t=>this.handleMemberPermissionRoleChange(e,t,s),availableRoleItems:i})}renderReprovisioning(){return d.createElement(d.Fragment,null,a()(be.Z,{isMultiline:!0,style:{width:"80%"}},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.reprovisioningTab.workspaceOwner.caption",defaultMessage:"View users that were previously part of the workspace in the past 30 days. Only workspace owners can see this.",description:"Description that shows on the transfer content tab in settings"})),a()(be.Z,{isMultiline:!0,style:{width:"80%"}},void 0,a()(w.FormattedMessage,{id:"spacePermissionsSettings.reprovisioningTab.workspaceOwner.caption.disclaimer",defaultMessage:"Note: only users who had private pages will appear here.",description:"Disclaimer that shows under the caption describing the reprovisioning tab in the members panel in settings."})),a()(re.Z,{size:24,isHidden:!0}),a()(me.Z,{requestStore:this.stores.getRecoverableSpaceUserContentRequestStore,request:{spaceId:this.props.store.id},performRequest:async e=>{const t=await T.getRecoverableSpaceUserContent(this.environment,{spaceId:e.spaceId});if("failed"===t.type)throw P.showError(t),t;return t.data},render:this.renderReprovisioningData}))}renderRequestsTab(){return a()(ze,{spaceStore:this.props.store,accessRequestsStore:this.stores.accessRequestsStore})}renderNumberOfRequests(){return a()(me.Z,{throttle:1e3,request:{parentTable:"space",parentId:this.props.store.id,size:100,status:"pending"},requestStore:this.stores.accessRequestsStore,performRequest:async e=>{const t=await T.getAccessRequests(this.environment,e);if("failed"===t.type)throw t.error;const s=t.data.accessRequestIds;return(0,C.Tr)(this.props.store,s)},render:(e,t,s)=>e||!t?a()("span",{}):t?a()("span",{},void 0,t.filter((e=>"pending"===e.accessRequestStore.getKeyStore("status").getValue())).length):void 0})}handleConvertToMember(e){const{user:t,userStore:s,parent:i}=e,r=s.getEmail();P.showDialog({message:a()(w.FormattedMessage,{id:"spacePermissionsSettings.externalTab.userThreeDotMenu.convertToMember.confirmationDialog.message",defaultMessage:"Are you sure you want to convert this user into a workspace member?",description:"Message to confirm converting user into a workspace member."}),description:a()(w.FormattedMessage,{id:"spacePermissionsSettings.externalTab.userThreeDotMenu.convertToMember.confirmationDialog.description",defaultMessage:"This is a billable event.",description:"Additional description explaining the action will completely remove the user from the space."}),showCancel:!0,keepFocus:!1,handleCancel:()=>{P.dismissDialog(),i.close()},items:[{label:a()(w.FormattedMessage,{id:"spacePermissionsSettings.externalTab.userThreeDotMenu.convertToMember.confirmationDialog.confirm",defaultMessage:"Convert to workspace member",description:"Label for button to confirm converting the teamspace or page guest into a workspace member."}),color:"blue",onAccept:async()=>{i.close();"success"===(await T.convertTeamGuestToMember(this.environment,{spaceId:this.props.store.id,teamRole:"member",userId:t.userId})).type?(F.oV({label:a()(w.FormattedMessage,{id:"spacePermissionsSettings.externalTab.userThreeDotMenu.convertToMember.snackbar.success",defaultMessage:"Successfully converted {email} to workspace member",description:"Snackbar message shown after successfully converting a page guest or teamspace guest into a workspace member.",values:{email:r}})}),await G.bi(this.environment)):F.oV({label:a()(w.FormattedMessage,{id:"spacePermissionsSettings.externalTab.userThreeDotMenu.convertToMember.snackbar.failure",defaultMessage:"Failed to convert {email} to workspace member",description:"Snackbar message shown after failing to convert a page guest or teamspace guest into a workspace member.",values:{email:r}})})}}]})}handleRemoveFromWorkspace(e){const{user:t,userStore:s,parent:i}=e,r=s.getEmail();P.showDialog({message:a()(w.FormattedMessage,{id:"spacePermissionsSettings.externalTab.userThreeDotMenu.removeFromWorkspace.confirmationDialog.message",defaultMessage:"Are you sure you want to remove this user from the workspace?",description:"Message to confirm removal of user from the workspace."}),description:a()(w.FormattedMessage,{id:"spacePermissionsSettings.externalTab.userThreeDotMenu.removeFromWorkspace.confirmationDialog.description",defaultMessage:"This action will completely remove the user from the workspace, including any teamspaces and pages they have access to.",description:"Additional description explaining the action will completely remove the user from the space."}),showCancel:!0,keepFocus:!1,handleCancel:()=>{P.dismissDialog(),i.close()},items:[{label:a()(w.FormattedMessage,{id:"spacePermissionsSettings.externalTab.userThreeDotMenu.removeFromWorkspace.confirmationDialog.confirm",defaultMessage:"Remove from workspace",description:"Label for button to confirm removal of user from the workspace."}),color:"red",onAccept:async()=>{i.close();"success"===(await T.removeUsersFromSpace(this.environment,{spaceId:this.props.store.id,userIds:[t.userId],revokeUserTokens:!0,removePagePermissions:!0})).type?(F.oV({label:a()(w.FormattedMessage,{id:"spacePermissionsSettings.externalTab.userThreeDotMenu.removeFromWorkspace.snackbar.success",defaultMessage:"Successfully removed {email} from workspace",description:"Snackbar message shown after successfully removing a page guest or teamspace guest.",values:{email:r}})}),await G.bi(this.environment)):F.oV({label:a()(w.FormattedMessage,{id:"spacePermissionsSettings.externalTab.userThreeDotMenu.removeFromWorkspace.snackbar.failure",defaultMessage:"Failed to remove {email} from workspace",description:"Snackbar message shown after failing to remove a page guest or teamspace guest.",values:{email:r}})})}}]})}getSpaceRecoverRows(e){const t=[];for(const{userId:s,privatePagesCount:i}of e){if(i<1)continue;const e=z.U6.createChildStore(this.props.store,{table:b.KJ,id:s}).getValue();t.push({key:s,columns:[this.renderMember(e),i,this.userIdsWithContentBeingReprovisioned.state.includes(s)?a()(ne.Z,{}):a()("div",{style:{marginLeft:-4}},void 0,a()($e.Z,{mode:Je.z.Button,focused:!1,title:a()(w.FormattedMessage,{id:"spacePermissionsSettings.reprovision.toUser.title",defaultMessage:"Transfer private pages"}),parentStore:this.props.store,userIds:this.userIdsWithContentBeingReprovisioned.state,onChange:e=>{let[t]=e;this.handleReprovisionToUserChange(s,t)}}))]})}return t}setInitialSubtabOnMount(){Q.Z.state.open&&"members"===Q.Z.state.currentTab&&Q.Z.state.defaultSubtab&&(this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,currentTab:Q.Z.state.defaultSubtab}),Q.Z.setState({...Q.Z.state,defaultSubtab:void 0}))}getAvailableRoleItems(){const e=this.props.intl.formatMessage({id:"spacePermissionSettings.memberRoleSelect.permissionitem.roleUpgradeDisabled",defaultMessage:"Cannot upgrade to a higher role than member",description:"Tooltip shown over disabled role upgrades"}),t=(0,_.U7)();return l().compact(g.an.map((s=>{if(t||"membership_admin"!==s)return{role:s,disabledInfo:!this.canAdmin()&&g.Bc(s)?{isDisabled:!0,disabledMessage:e}:void 0}})))}getCurrentTabs(e){return[j.Q.Members,j.Q.Groups,...e.length>0?[j.Q.Guests]:[],...this.canReprovisionContent()?[j.Q.Reprovisioning]:[],...this.shouldShowRequestsTab()?[j.Q.Requests]:[]]}isSubscribed(){const{data:e}=$.default.state;return Boolean(e&&D.YK(e))}canAdmin(){return this.props.store.canAdmin()}canEditMembership(){return this.props.store.canEditMembership()}canUseGroups(){return D.qF(this.environment)&&this.isSubscribed()}canEditGroups(){return this.canUseGroups()&&this.canEditMembership()}canUseInviteLink(){return this.canEditMembership()&&D.qF(this.environment)}canReprovisionContent(){return this.canAdmin()&&E.wP()&&"on"===N.default.getGroup("content-reprovisioning")}shouldShowRequestsTab(){return this.canEditMembership()&&(0,q.p1)()}getInviteLinkEnabled(){return Boolean(this.props.store.getKeyStore("invite_link_enabled").getValue())}getInviteLink(){if(!this.canEditMembership())return;const e=$.default.state.data,t=this.props.store.id,s=e&&("subscribed_admin"===e.type||"unsubscribed_admin"===e.type||"subscribed_membership_admin"===e.type)&&e.inviteLinkCode;return s?(0,U.createSpaceInviteLinkUrl)(this.environment,t,s):void 0}getSearchIconStyle(){return{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:this.theme.mediumIconColor}}mobileMenuItemStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",paddingTop:14,paddingBottom:14,paddingLeft:14,paddingRight:e.getSafePaddingRightCSS(14),background:this.theme.cardContentBackground}}}Nt.defaultLimit=50,Nt.filterStyle={maxWidth:275,borderRadius:30},Nt.showMoreButtonStyle={marginTop:8};const zt=(0,w.injectIntl)(Nt)},88775:(e,t,s)=>{s.d(t,{Z:()=>I});var i=s(97464),r=s.n(i),o=s(77094),a=s.n(o),n=s(67294),l=s(480),d=s(16489),u=s(24405),m=s(3779),c=s(5366),p=s(33929),g=s(60709),h=s(33846),b=s(48690),f=s(30397),v=s(48019),S=s(52275),y=s(31945),M=s(68894),w=s(78140),C=s(89728),k=s(72495),T=s(64369),Z=s(93686);const P=(0,c.defineMessages)({filterTeams:{defaultMessage:"Filter teamspaces…",id:"teamsDropdownForMember.filterForTeams.placeholder",description:"Placeholder text for filtering teamspaces within a group."}});function R(e){const t=(0,l.O7)(),s=(0,u.yK)((()=>({teamMenuItem:{fontWeight:400,maxWidth:180}})),[]),[i,o]=(0,d.AF)(void 0,h.Z),[,m]=(0,d.AF)(b.Z),f=(0,n.useCallback)((e=>{m((t=>({...t,open:!0,tab:b.a.Members,selectedTeamId:e})))}),[m]),y=(0,d.VK)((()=>[{key:"teams for member",render:e=>n.createElement(k.Z,e),actions:e.teamStores.map((e=>({key:e.id,displayName:e.getName(),analyticsName:e.getName()||"team_unknown",searchName:e.getName(),render:t=>n.createElement(S.Z,r()({icon:a()(Z.p,{disabled:!0,store:e}),title:a()(T.Z,{style:s.teamMenuItem},void 0,e.getName()),caption:a()(c.FormattedMessage,{defaultMessage:"{numMembers} {numMembers, plural, one {member} other {members}}",id:"teamsDropdownForMember.numMembers",description:"Number of members in a teamspace, displayed in a popup showing teamspaces that a member is part of.",values:{numMembers:e.getUserIdsInTeam().length}}),inline:!0},t)),action:()=>{f(e.id)},closeParentMenu:!1})))}]),[e.teamStores,s.teamMenuItem,f]),C=i.inputValue,R=a()(k.Z,{isInput:!0},void 0,a()(M.ZP,{value:C,onChange:(0,n.useCallback)((e=>{o({inputValue:e.target.value,focus:!1})}),[o]),focus:!0,focusAfterAnimation:!0,placeholder:p.default.formatMessage(P.filterTeams)})),I={menuType:g.o.Popup,maxWidth:350,maxHeight:300,header:e.teamStores.length>5?R:void 0};return n.createElement(w.Z,I,a()(v.Z,{filter:C,context:{blocks:[],environment:t,publicEditMode:void 0},initialFocus:0,sections:y}))}const I=function(e){const[t]=(0,d.AF)(f.Z),s=(0,u.yK)((e=>({button:{marginRight:8},noTeams:{marginRight:8,color:e.lightTextColor},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),i=(0,d.VK)((()=>t.teams.filter((t=>t.getMembers().some((t=>"user"===t.entity_type&&t.user_id===e.member.userId))))),[t,e.member]),o=i.length;return a()(y.Z,{popupType:y.Z.PopupType.Popup,renderOrigin:e=>n.createElement(C.Z,r()({disabled:0===o,style:0===o?s.noTeams:s.button},e),0===o?a()(c.FormattedMessage,{id:"teamsDropdownForMember.teamsCountNone.label",defaultMessage:"None",description:"Message to show a member is not part of any teamspaces."}):n.createElement(n.Fragment,null,a()(c.FormattedMessage,{id:"teamsDropdownForMember.teamsCount.label",defaultMessage:"{numberOfTeams, plural, one {{numberOfTeams} teamspace} other {{numberOfTeams} teamspaces}}",description:"Number of teamspaces that a member is part of.",values:{numberOfTeams:o}}),m.Z.chevronDown(s.chevron))),render:()=>a()(R,{member:e.member,teamStores:i})})}},69435:(e,t,s)=>{s.d(t,{Z:()=>h});var i=s(77094),r=s.n(i),o=(s(67294),s(83355)),a=s(82990),n=s(5366),l=s(50906),d=s(26111),u=s(93678),m=s(33665),c=s(42922),p=s(63296);class g extends o.Z{constructor(){super(...arguments),this.handleUpgradeClick=e=>{const{from:t,for:s,onUpgradeClick:i}=this.props;u.y(this.environment,{from:t,for:s}),i&&i(e)},this.handleLearnMoreClick=()=>{const{from:e,learnMoreRoute:t}=this.props;(0,d.navigateToExternalURL)({environment:this.environment,url:(0,m.UY)(t)}),l.trackClickHelpButton(this.environment,{from:e})}}renderComponent(){return r()("section",{style:this.getWrapStyle()},void 0,this.renderIcon(),this.renderTitle(),this.renderCaption(),this.renderActions())}renderIcon(){const{icon:e}=this.props;if(e)return e(this.getIconStyle())}renderTitle(){const{title:e}=this.props;return r()("header",{style:this.getTitleStyle()},void 0,e)}renderCaption(){const{caption:e}=this.props;return r()("p",{style:this.getCaptionStyle()},void 0,e)}renderActions(){return r()("footer",{},void 0,this.renderUpgradeButton(),this.renderLearnMoreButton())}renderUpgradeButton(){const{upgradeMessage:e}=this.props;return r()(c.Z,{onClick:this.handleUpgradeClick,isLarge:!0},void 0,e||r()(n.FormattedMessage,{defaultMessage:"Upgrade",id:"upsellCallout.upgradeButton.text"}))}renderLearnMoreButton(){return r()(p.Z,{onClick:this.handleLearnMoreClick,style:this.getLearnMoreButtonStyle()},void 0,r()(n.FormattedMessage,{defaultMessage:"Learn more",id:"upsellCallout.learnMoreButton.text"}))}getWrapStyle(){const{device:e}=this.environment;return{...this.props.style,fontSize:14,...!e.isMobile&&{maxWidth:340}}}getIconStyle(){return{width:32,height:"auto",fill:this.theme.mediumIconColor,marginBottom:8}}getTitleStyle(){return{fontWeight:a.Z.fontWeight.semibold}}getCaptionStyle(){return{color:this.theme.mediumTextColor,marginTop:4,marginBottom:16}}getLearnMoreButtonStyle(){return{marginLeft:12}}}const h=g},40394:(e,t,s)=>{s.d(t,{b:()=>g,D:()=>h});var i=s(77094),r=s.n(i),o=s(67294),a=s(24405),n=s(3779),l=s(82990),d=s(12534),u=s(75024),m=s(12508),c=s(84787),p=s(89728);function g(e){let{columnRenderInfo:t,theme:s,containerMarginTop:i}=e;return{container:{marginTop:i??17,tableLayout:"fixed",borderCollapse:"collapse",width:"100%",minWidth:t.reduce(((e,t)=>e+w(t.widthData)+y),0)},tableHeaderRow:{},paddingRowCell:{height:8},firstColumn:{}}}function h(e){let{columnRenderInfo:t,sortState:s,onSortStateChanged:i,showRowBorders:n,hideHeaderRowPadding:l,renderRowChild:d,rows:u,onRowClick:m,renderNoRowsComponent:p,styles:g,getStyleForRow:h,multiselect:v,onScrollBottom:S,allowHorizontalScroll:y,maxHeight:M,setStickyHeaderRow:w}=e;const C=(0,a.yK)((e=>({horizontalScrollContainer:{position:"relative",width:"100%",display:"grid",overflow:"auto"},scrollableContainer:{maxHeight:M,position:"relative",display:"grid",overflowX:"auto",width:"100%"},table:y?{...g.container,minWidth:"100%",width:void 0}:g.container})),[g.container,y,M]),k=(0,o.useCallback)((e=>{var t;if(!s)return;const r=e.id===(null===(t=s.column)||void 0===t?void 0:t.id)&&!s.sortAscending;i&&i({sortAscending:r,column:e})}),[s,i]),T=o.createElement(o.Fragment,null,r()("table",{style:C.table},void 0,r()("tr",{style:g.tableHeaderRow},void 0,t.map(((e,t)=>r()(b,{index:t,column:e,sortState:s,handleSortableColumnClick:k,shouldShowSortIcon:0!==u.length,multiselect:v,allowHorizontalScroll:y,setStickyHeaderRow:w,style:0===t?g.firstColumn:void 0},`header_${e.id}`)))),!l&&r()("tr",{},void 0,t.map((e=>r()("td",{style:g.paddingRowCell},`padding_row_${e.id}`)))),u.map((e=>r()(f,{columns:t,onRowClick:m,rowChild:null==d?void 0:d(e),showRowBorders:n,row:e,getStyleForRow:h,multiselect:v,allowHorizontalScroll:y,firstColumnStyle:g.firstColumn},`${e.id}_row`))),!y&&S&&r()(c.Z,{loading:!1,loadMoreOffsetThreshold:100,onLoadMore:S})),0===u.length&&p());return y?r()("div",{style:C.horizontalScrollContainer},void 0,r()("div",{style:C.scrollableContainer},void 0,T,M&&S&&r()(c.Z,{loading:!1,loadMoreOffsetThreshold:100,onLoadMore:S})),!M&&S&&r()(c.Z,{loading:!1,loadMoreOffsetThreshold:100,onLoadMore:S})):r()("div",{style:{maxHeight:M}},void 0,T)}function b(e){let{column:t,index:s,sortState:i,handleSortableColumnClick:o,shouldShowSortIcon:d,multiselect:u,allowHorizontalScroll:c,setStickyHeaderRow:g,style:h}=e;const b=0===s,f=1===s,v=(0,a.yK)((e=>({th:{boxShadow:`\n\t\t\t\t\tinset 0 1px 0 ${e.tableDividerColor},\n\t\t\t\t\tinset 0 -1px 0 ${e.tableDividerColor}\n\t\t\t\t`,...g&&{position:"sticky",top:0,zIndex:3,background:e.modalBackground},...C(t),...c&&b&&{position:"sticky",zIndex:4,left:0,background:e.modalBackground,boxShadow:`\n\t\t\t\t\t\t\tinset -1px 0px 0px ${e.tableDividerColor},\n\t\t\t\t\t\t\tinset 0 1px 0 ${e.tableDividerColor},\n\t\t\t\t\t\t\tinset 0 -1px 0 ${e.tableDividerColor}\n\t\t\t\t\t\t`,paddingRight:15},...c&&f&&{paddingLeft:15},height:32,...h},innerDiv:{display:"flex",alignItems:"center",height:"100%",minWidth:w(t.widthData),maxWidth:t.widthData.maxWidth},text:{fontSize:l.Z.fontSize.UISmall.desktop,fontWeight:l.Z.fontWeight.regular,color:e.mediumTextColor,...l.Z.textOverflowStyle},sortButton:{padding:5,margin:-5},sortIcon:{color:e.mediumTextColor,width:12,height:12,marginLeft:4,fill:"currentColor"},multiselectCheckbox:{color:e.selectLightGray[300],marginRight:16,opacity:null!=u&&u.header.isDisabled?.5:1}})),[t,u,c,g,h,b,f]),S=r()("div",{style:v.text},void 0,t.headerTitle),y=t.sortable?r()(p.Z,{style:v.sortButton,onClick:()=>o(t)},void 0,S,(()=>{if(i&&d&&t.id===i.column.id)return n.Z.arrowDownSmall({...v.sortIcon,...i.sortAscending&&{transform:"rotate(180deg)"}})})()):S,M=void 0!==u&&0===s?r()(m.Z,{style:v.multiselectCheckbox,disabled:u.header.isDisabled,onClick:()=>u.header.onClick(),checked:u.header.isSelected,size:14}):null;return r()("th",{style:v.th},void 0,r()("div",{style:v.innerDiv},void 0,M,y))}function f(e){let{row:t,columns:s,onRowClick:i,rowChild:n,showRowBorders:l,getStyleForRow:d,allowHorizontalScroll:u,multiselect:m,firstColumnStyle:c}=e;const[p,g]=(0,o.useState)(!1),h=t.isClickable,b=(0,o.useCallback)((()=>g(!0)),[]),f=(0,o.useCallback)((()=>g(!1)),[]),y=(0,o.useCallback)((e=>{h&&void 0!==i&&S(e,(()=>i(t.id)))}),[h,i,t.id]),M=(0,a.yK)((e=>({row:{height:1,...h&&{cursor:"pointer"},...l&&{borderBottom:`1px solid ${e.tableDividerColor}`},...d&&d(t)}})),[h,l,d,t]);return o.createElement(o.Fragment,null,r()("tr",{onMouseLeave:f,onMouseEnter:b,style:M.row,onClick:y},void 0,s.map(((e,i)=>r()(v,{isRowHovered:p,isRowClickable:h,columnIndex:i,numColumns:s.length,data:t,column:e,multiselect:m,allowHorizontalScroll:u,cellStyle:0===i?c:void 0},`cell_${t.id}_${e.id}`)))),n&&r()("tr",{style:M.row},void 0,r()("td",{colSpan:s.length},void 0,n)))}function v(e){let{data:t,column:s,columnIndex:i,numColumns:o,isRowHovered:n,isRowClickable:d,multiselect:c,allowHorizontalScroll:p,cellStyle:g}=e;const h=0===i,b=1===i,f=i===o-1,v=(0,a.yK)((e=>({td:{...C(s),height:"inherit",...h&&{borderRadius:(0,u.wK)({topLeft:3,bottomLeft:3})},...f&&{borderRadius:(0,u.wK)({topRight:3,bottomRight:3})},...p&&h&&{position:"sticky",zIndex:2,left:0,background:e.modalBackground,boxShadow:`inset -1px 0px 0px ${e.tableDividerColor}`,paddingRight:15},...p&&b&&{paddingLeft:15},...n&&d&&{background:e.buttonHoveredBackground},...g},innerDiv:{minWidth:w(s.widthData),maxWidth:s.widthData.maxWidth,fontSize:l.Z.fontSize.UIRegular.desktop,color:e.regularTextColor,minHeight:42,display:"flex",alignItems:"center",height:"100%"},multiselectCheckbox:{color:e.selectLightGray[300],marginRight:16,opacity:null!=c&&c.row.getDisabledState(t)?.5:1}})),[s,h,b,f,n,d,c,t,p,g]),y=Boolean(s.hasClickableContents),M=c&&h?r()(m.Z,{style:v.multiselectCheckbox,checked:c.row.getSelectedState(t),onClick:()=>c.row.onClick(t),disabled:c.row.getDisabledState(t),size:14}):null;return r()("td",{style:v.td},void 0,r()("div",{style:v.innerDiv,onClick:y?S:void 0},void 0,M,s.renderCell({...t,isRowHovered:n})))}const S=(e,t)=>{(0,d.ZP)({event:e,context:d.Af.BaseTableRowClick,callback:t})},y=10,M={paddingLeft:y/2,paddingRight:y/2};function w(e){return"minWidth"in e?e.minWidth:e.width}function C(e){let t;return t="width"in e.widthData?{width:e.widthData.width}:{width:`${e.widthData.widthPercent}%`,minWidth:e.widthData.minWidth},{...M,...t}}},88198:(e,t,s)=>{s.d(t,{b:()=>m});var i=s(77094),r=s.n(i),o=s(67294),a=s(24405),n=s(3779),l=s(26825),d=s(5366),u=s(74136);function m(e){const{style:t}=e,s=(0,a.yK)((()=>({container:{display:"flex",alignItems:"center",color:"#CF8807",background:"rgba(246, 192, 80, 0.26)"}})),[]);return r()(u.Z,{innerStyle:{...s.container,...t}},void 0,n.Z.globe2({width:9,fill:"#CF8807",display:"inline",verticalAlign:"middle",marginRight:2}),o.createElement(d.FormattedMessage,l.mq.guestLabel))}},83890:(e,t,s)=>{s.d(t,{Z:()=>w});var i=s(97464),r=s.n(i),o=s(77094),a=s.n(o),n=s(67294),l=s(83355),d=s(66897),u=s(3779),m=s(19889),c=s(7928),p=s(5366),g=s(31299),h=s(44653),b=s(92864),f=s(93044),v=s(255),S=s(97680),y=s(98707);class M extends l.Z{constructor(){super(...arguments),this.renderFilterListItem=(e,t)=>{let{disabled:s,onRemove:i,onClick:r}=t;const o=this.styles,n=this.getUserValue(e),l=a()(v.Z,{disabled:s,onClick:i});return a()(S.Z,{disabled:s,focused:!1,user:n,right:l,style:o.menuItem,desktopTitleStyle:o.menuItemTitle,onClick:r},e)},this.renderItemForSummary=e=>(0,c.Nz)(this.props.intl,this.getUserValue(e)),this.renderToken=(e,t)=>{const{userIds:s}=this.props,i=1===s.length,r=this.getUserValue(e);if(r)return a()(b.ZP,{format:this.environment.device.isMobile?f.Z.Format.Large:f.Z.Format.Small,showRemoveButton:!0,isSingle:i,onClickRemove:t.onRemove,actor:(0,d.m3)(r),shouldShrink:!0,backgroundColor:"transparent"},e)},this.renderResultMenuItem=(e,t)=>{const s=this.getUserValue(e);return n.createElement(S.Z,r()({},t,{key:e,user:s}))},this.performRequest=async e=>{let{query:t,current:s}=e;const i=new Set(s);return(await g.Yu({environment:this.environment,query:t,membersOnly:!1})).filter((e=>!i.has(e.id))).slice(0,20).map((e=>e.id))},this.getUserValue=e=>this.createUserStore(e).getValue(),this.createUserStore=e=>{const{parentStore:t}=this.props;return h.U6.createChildStore(t,{table:m.KJ,id:e})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{marginRight:2,fill:"currentColor"}}}renderComponent(){const{mode:e,title:t,userIds:s,onChange:i,disabled:r,focused:o,onMenuDismiss:n,intl:l}=this.props;return a()(y.Z,{mode:e,title:t,icon:u.Z.person,iconStyles:this.styles.recordIcon,items:s,onChange:i,disabled:r,focused:o,renderFilter:this.renderFilterListItem,renderToken:this.renderToken,renderItemForSummary:this.renderItemForSummary,addItemLabel:a()(p.FormattedMessage,{defaultMessage:"Add a person",id:"search.filterMenu.addAPersonButton.label"}),labelText:{title:t,tokenInputPlaceholder:l.formatMessage({defaultMessage:"Search people",id:"search.filterMenu.searchPeople.placeholder"}),componentDebugName:"SearchPersonFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,onMenuDismiss:n,hasItemsSelected:(null==s?void 0:s.length)>0})}}const w=(0,p.injectIntl)(M)},53680:(e,t,s)=>{s.d(t,{Z:()=>o});var i=s(49085);class r extends i.Z{getInitialState(){return{disablePublicAccess:!1,disableGuests:!1,disableMoveToSpace:!1,disableExport:!1,disableSpacePageEdits:!1,disablePublicAccessRequests:!1,disableTeamCreation:!1,disableMembershipRequests:!1,disableGuestMembershipRequests:!1,enableAiFeature:!1,disableTeamGuests:!1}}getValueForSpace(e){if(e.isDefined())return{disablePublicAccess:Boolean(e.getDisablePublicAccess()),disableGuests:Boolean(e.getDisableGuests()),disableMoveToSpace:Boolean(e.getDisableMoveToSpace()),disableExport:Boolean(e.getDisableExport()),disableSpacePageEdits:Boolean(e.getDisableSpacePageEdits()),disablePublicAccessRequests:Boolean(e.getDisablePublicAccessRequests()),disableTeamCreation:Boolean(e.getDisableTeamCreation()),disableMembershipRequests:Boolean(e.getKeyStore("settings").getKeyStore("disable_membership_requests").getValue()),disableGuestMembershipRequests:Boolean(e.getKeyStore("settings").getKeyStore("disable_guest_membership_requests").getValue()),enableAiFeature:Boolean(e.getKeyStore("settings").getKeyStore("enable_ai_feature").getValue()),disableTeamGuests:Boolean(e.getKeyStore("settings").getKeyStore("disable_team_guests").getValue())}}}const o=r},98905:(e,t,s)=>{s.d(t,{Z:()=>o});var i=s(49085);class r extends i.Z{getInitialState(){return{count:0}}}const o=new r}}]);